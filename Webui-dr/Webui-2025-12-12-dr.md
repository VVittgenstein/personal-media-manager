# Research Report — 个人媒体库本地WebUI项目
- 版本/时间戳：2025-12-12
- 研究窗口：近12–18个月（侧重当前活跃的自托管媒体管理技术和Web性能优化方案；必要时参考更早但仍适用的开源项目）
- 执行摘要：
  - **项目目标**：打造一个在Windows本机运行的个人媒体库Web界面，实现按照“图片相册/散图/视频/游戏/其他”分类浏览本地媒体文件，并提供文件删除、移动整理等管理功能，在不上传云端的前提下提升浏览效率和操作安全性。
  - **核心需求**：以目录结构组织图片为“相册”，展示封面缩略图（随机4图拼接）；扁平列表显示未归档的“散图”和所有视频文件（均生成2×2缩略图预览）；点击缩略图在同页弹出Overlay查看大图或播放视频:contentReference[oaicite:0]{index=0}；提供文件搜索（按名称模糊匹配）:contentReference[oaicite:1]{index=1}；支持文件/文件夹删除与移动（限MediaRoot内，二次确认，操作日志，考虑软删除）。
  - **技术约束**：纯本地部署（通过启动脚本开启localhost服务），前端响应式适配多种屏幕尺寸；不依赖任何需联网的云API。需兼顾大体量文件的性能（缩略图缓存、懒加载:contentReference[oaicite:2]{index=2}:contentReference[oaicite:3]{index=3}）以及多媒体播放能力（争取支持4K@240fps超高清，受硬件解码性能限制）。
  - **先例评估**：调研了Photoview:contentReference[oaicite:4]{index=4}:contentReference[oaicite:5]{index=5}、FileBrowser:contentReference[oaicite:6]{index=6}、Jellyfin等开源项目。Photoview符合“目录即相册、自动扫描生成缩略图、懒加载”理念:contentReference[oaicite:7]{index=7}:contentReference[oaicite:8]{index=8}，但其AGPL许可和对非媒体文件支持不足；FileBrowser提供通用文件管理界面（上传/预览/编辑）:contentReference[oaicite:9]{index=9}且开源许可宽松，但仅按目录浏览，缺少定制的相册封面和视频缩略图功能，且项目维护活跃度降低:contentReference[oaicite:10]{index=10}。Jellyfin等媒体服务器功能最全面（涵盖视频流媒体、多终端）:contentReference[oaicite:11]{index=11}，但部署和定制成本高、偏重影音元数据而非文件夹视图，不适合轻量本地工具。
  - **方案结论**：推荐自主开发定制WebUI方案。即采用Python+Flask后端结合现代前端框架（例如React），扫描MediaRoot目录构建媒体索引，并利用Pillow和FFmpeg生成缓存缩略图；前端实现单页应用的分类视图和Overlay播放器，支持文件搜索与管理。此方案在功能契合度和可扩展性方面得分最高，团队可完全掌控实现细节和安全措施，且可避免AGPL等严格开源许可的限制。
  - **可行性依据**：Photoview等项目验证了以本地文件系统为基础组织媒体、后台预生成缩略图及前端懒加载的性能优势:contentReference[oaicite:12]{index=12}；FFmpeg可高效抽取视频关键帧作为预览缩略图:contentReference[oaicite:13]{index=13}；现代浏览器支持HTML5视频播放和全屏API，可满足大部分常见格式的本地播放需求，针对浏览器不支持的格式可提示用户转码或用本机播放器打开。
  - **后续重点**：分阶段实现相册视图、散图整理、一键归档等功能；严格限制文件操作范围并提供回滚机制降低误删风险；优化大规模文件的加载体验（分页或虚拟列表、按需扫描更新）。验证4K高帧率视频在本地浏览器中的播放表现，并针对性能瓶颈制定缓解措施（如必要时自动降分辨率播放提示）。
- 问题定义：
  - **目标**：实现一个本地运行的媒体库WebUI，使用户能在浏览器中高效浏览管理MediaRoot目录下的图片、视频等文件。具体包括：按照目录层级自动归类图片为相册并生成封面缩略图；聚合显示未整理的散落图片和所有视频，提供直观预览；点击媒体后在当前页弹出查看（图片适应窗口缩放、视频直接播放）；提供文件删除、移动整理功能（仅限MediaRoot内，有确认和日志）；提供按文件名搜索定位功能。
  - **非目标**：不涉及云端同步或多用户远程访问（即不做成公开分享的网盘）；不开发复杂的媒体内容分析功能（如人脸识别、标签分类等AI算法）；暂不深入实现游戏启动管理（游戏入口仅占位）；不专门构建移动端App（仅要求Web界面在PC浏览器中可用，移动端适配非刚需）。
  - **场景与约束**：典型使用场景是在Windows 10/11电脑上，用户双击启动脚本开启服务，浏览器自动打开localhost页面。系统需适配不同屏幕尺寸窗口（包括16:9显示器，全屏/窗口调整等），确保图片/视频在容器内等比最大化显示且无黑边（通过调整背景或容器避免纯色边框）。技术上限定为本地执行，不能依赖云API或需要外网连接；需要充分利用本地计算资源（CPU用于生成缩略图，GPU用于视频解码）。时间上希望尽快得到一个MVP演示基础浏览和删除功能，在此基础上再逐步增强整理效率和美观性。资源方面可依赖开源库，但要注意许可与Windows兼容性，不额外购置商业组件；团队主要由开发人员本人驱动，规模小，可接受一定开发工作但希望复用成熟模块减少造轮子。
  - **成功标准**（可量化）：页面加载和媒体预览速度显著优于直接用资源管理器翻看文件夹（目标：首屏<3秒加载UI及缩略图，进入相册或列表<2秒）; 支持至少数千张图片和数百部视频的库规模下仍能流畅浏览（滚动掉帧不明显，内存占用可控）；误操作率趋零（所有删除移动操作需确认，实际未出现越权删除）；视频播放流畅度接近本地播放器，在硬件允许下4K@60fps无卡顿（4K@240fps如硬件达不到则在项目说明中注明）；搜索按名称能在<1秒内返回结果；用户满意度主观提升，定位文件的平均耗时减少（例如，对比以往在复杂多层级文件夹中查找照片，现在可通过搜索或按相册归类快速找到）。
- 背景与术语：
  - **MediaRoot**：用户指定的媒体文件根目录，WebUI只对此目录及其子项进行扫描和操作，避免越权访问其他路径。所有文件管理操作（删除、移动）均限定在MediaRoot内部，作为安全沙箱。
  - **相册（Album）**：指MediaRoot下的“叶子图片目录”，即目录直接包含若干图片文件，且其任一子目录/后代目录都不再包含图片。若某目录本身含图片但其子目录/后代目录也含图片，则该父目录仅作为容器，不计为相册；仅叶子含图目录作为相册在界面中以卡片呈现（拼接封面缩略图+文件夹名称）。
  - **散图（Scattered Images）**：未归入任何相册路径（Album path）的图片文件，即只要图片不在任一相册目录树下（不限制深度）就属于散图；这既包括MediaRoot根目录下的图片，也包括例如`MediaRoot/tmp/foo.jpg`这类位于非相册嵌套目录中的图片。散图将在专门的“散图”视图中以平铺列表形式列出。用户可一键将所有散图移动到一个预设的“_unsorted”子目录以便稍后分类归档。
  - **视频缩略图**：对于视频文件，系统将使用FFmpeg从视频中截取多个帧画面生成预览缩略图（2×2宫格图片）:contentReference[oaicite:14]{index=14}。通常从视频的不同时刻提取4帧（例如均匀间隔或利用场景变换检测），以尽量代表视频内容。生成的缩略图用于在视频列表中展示以及Overlay播放器加载前的封面图。
  - **Overlay查看器**：一种悬浮层（modal）显示方式。当用户点击某图片或视频缩略图时，当前页面上浮现全屏居中的查看窗口。图片查看overlay支持左右切换浏览同一相册内的上一张/下一张图片；视频播放overlay提供播放/暂停、进度、音量、全屏切换等控制，点击空白处或关闭按钮可退出overlay回到原界面。Overlay的实现确保不刷新整页，关闭后返回之前浏览的位置。
  - **宽高比自适应**：媒体文件（图片或视频）在查看器或缩略图容器中保持原始宽高比例缩放。默认缩放使其一边贴合容器且完整可见，不对内容进行拉伸或裁剪。对于与容器比例不一致的情况，背景采用适当颜色或模糊填充以避免纯色边框（俗称“黑边”）。例如，16:9的视频在21:9的显示区域播放时，可采用黑色背景填充上下区域，但本项目中将尝试用更友好的方式处理（如半透明背景或调整容器大小以无明显黑边）。
  - **懒加载（Lazy Loading）**：一种性能优化策略，推迟加载非首屏必要的资源:contentReference[oaicite:15]{index=15}。在本项目中，对长列表中的缩略图采用懒加载，即只有当图片滚动到可视区域附近时才加载其缩略图数据，未显示部分不加载或加载低清预览。这将显著减少初始加载时间和内存占用，提升大库浏览的流畅度:contentReference[oaicite:16]{index=16}。HTML5提供了<img loading="lazy">属性以及Intersection Observer API可方便实现懒加载。
  - **软删除（回收站）**：一种删除文件的安全策略，即删除操作并不直接物理移除文件，而是将文件移动到预设的回收站文件夹内保存。这样用户如发现误删可从回收站复原。本项目视时间与复杂度决定是否实现软删除，默认至少提供普通删除的“二次确认”对话框及日志记录。
  - **FFmpeg**：一个广泛使用的开源多媒体处理工具库，支持音视频解码、转码和截图等功能。项目将利用FFmpeg从视频中提取帧图像来生成视频缩略图:contentReference[oaicite:17]{index=17}。FFmpeg可以通过命令行指定滤镜，如`-vf thumbnail`选取代表性帧或`select=gt(scene\,0.4)`按场景变化挑帧:contentReference[oaicite:18]{index=18}。因浏览器本身不提供直接获取视频帧缩略的API，需由后台预处理生成静态图片。
  - **响应式布局**：Web页面设计能根据不同屏幕尺寸和窗口大小调整布局。例如采用CSS网格或弹性布局，使5个入口卡片在小窗口时自动调整为2×3或单列列表。确保无论全屏、大屏或缩小窗口，界面元素都保持可读、无重叠或溢出。
  - *(示意架构图)*：如下是系统生态的最小架构示意：
    ```
    [Browser UI (HTML/JS/CSS)]  ←→  [本地 Flask Web服务]  ←→  [文件系统: MediaRoot]
         ↑ 前端懒加载请求缩略图       后端扫描目录/生成缩略图    ↙︎ 调用FFmpeg/Pillow处理媒体
         ↑ AJAX接口执行删除/移动        （日志记录，操作限定MediaRoot）
    ```
    浏览器与本地服务器通过HTTP通信。服务器启动后定期扫描或监听MediaRoot变化更新索引。前端初次加载时获取分类列表及缩略图路径，用户操作通过异步请求调用后端文件操作接口。
- 先例与对标：

| 对象 / 项目                | 类型           | 许可          | 关键能力                                           | 优点 / 劣势                                   | 采用门槛 (难度)             |
| -------------------------- | -------------- | ------------- | -------------------------------------------------- | --------------------------------------------- | -------------------------- |
| **Photoview**:contentReference[oaicite:19]{index=19}:contentReference[oaicite:20]{index=20}    | 自托管照片/视频馆 | AGPL-3.0      | 按文件夹组织相册；自动扫描生成缩略图；懒加载大库:contentReference[oaicite:21]{index=21}；多用户分享 | **优**: 功能贴合照片管理（目录即相册:contentReference[oaicite:22]{index=22}、地图/EXIF等额外信息）；性能优化成熟（缩略图缓存、按需加载:contentReference[oaicite:23]{index=23}）<br>**劣**: 不支持普通文件/游戏分类；部署需数据库(PostgreSQL)和后台服务，较重；AGPL许可证对定制发布有限制；界面定制难度较高（需改动前后端代码） | 安装稍复杂（Docker镜像可用）；需一定Go和前端技能修改定制；硬件资源占用中等（缓存缩略图占用磁盘，服务常驻占内存） |
| **FileBrowser**:contentReference[oaicite:24]{index=24}:contentReference[oaicite:25]{index=25}    | 通用文件管理WebUI | Apache-2.0    | 单一可执行文件运行；浏览指定路径文件夹结构:contentReference[oaicite:26]{index=26}；支持文件上传、删除、文本编辑等基本操作；可预览常见图片视频（调用浏览器原生能力） | **优**: 部署极简（一个二进制直接运行，指向目录即可用:contentReference[oaicite:27]{index=27}）；界面整洁易用；支持权限和多用户（可选）<br>**劣**: 无高级媒体特性（无相册封面拼图、视频缩略图）；UI仅按目录浏览，不符合项目“合并所有视频列表”等需求；缩略图需要浏览器逐个加载，缺乏集中缓存优化；项目目前仅维护修复模式，新功能不再增加:contentReference[oaicite:28]{index=28} | 非常易上手（零配置运行），修改源代码需要Go语言能力；适合简单文件管理，不满足定制UI需要时需二次开发或放弃 |
| **Jellyfin**:contentReference[oaicite:29]{index=29}:contentReference[oaicite:30]{index=30}       | 全面媒体服务器   | GPL-2.0       | 媲美商业Plex/Emby的系统：影音库元数据管理、封面海报、美术字体界面；多客户端支持（浏览器、移动端、电视端）；实时转码流媒体播放 | **优**: 功能丰富“开箱即用”，特别在视频领域（自动获取封面、分章节、字幕/流切换等）；可同步观看、用户管理完善:contentReference[oaicite:31]{index=31}:contentReference[oaicite:32]{index=32}<br>**劣**: 过于重量级，本地仅浏览管理文件需求下显得复杂；强调媒体元数据组织而非纯文件夹视图（需要预先扫描数据库分类）；无直接文件系统操作功能（不会提供文件删除移动的界面）；占用资源较高，初次扫描大库时间长 | 部署门槛较高（需安装服务器，配置媒体库，较多依赖）；对开发者要求高（庞大代码库，不易定制部分功能）；适合持续运行的服务器环境，不适合临时启动的工具 |
| **Files Gallery**:contentReference[oaicite:33]{index=33}:contentReference[oaicite:34]{index=34} (files.gallery) | 单文件PHP应用   | 免费基础版 (商业授权可选) | 将任意服务器文件夹变成带图形界面的文件/照片库:contentReference[oaicite:35]{index=35}；支持全部文件类型预览（浏览器支持范围内），包括图片、视频、音频、PDF等:contentReference[oaicite:36]{index=36}；实时排序、筛选功能:contentReference[oaicite:37]{index=37}；支持多用户登录和文件上传下载 | **优**: 部署非常简单（一个PHP文件，放入目录即可浏览该目录:contentReference[oaicite:38]{index=38}）；界面现代，功能完善（即时搜索、主题、批量下载、EXIF显示等）:contentReference[oaicite:39]{index=39}；对多媒体格式支持较好:contentReference[oaicite:40]{index=40}；性能通过CDN缓存优化缩略图:contentReference[oaicite:41]{index=41} | **劣**: 需要PHP运行环境（Windows需安装PHP或集成环境）；高级功能需要付费解锁许可证:contentReference[oaicite:42]{index=42}；默认按文件夹浏览，不提供自定义分类入口（无法直接聚合“所有视频”除非进入各子目录逐一看）；不支持直接执行.exe（游戏）文件 | PHP环境和基本配置需求；前端定制需看其源码（JS+CSS较大单文件）；免费版弹出许可提示，对体验略有影响 |

*(备注：以上先例中，Photoview和Jellyfin为活跃维护项目，社区支持较强但需遵守严格开源协议；FileBrowser和Files Gallery更偏向个人/小团队维护，功能定型但可能难满足全部需求。本项目可参考这些先例的优点，例如Photoview的性能策略和FilesGallery的界面交互，在自研过程中加以融合。)*

- 方案空间与推荐：
  - **方案A：基于Photoview二次开发** – *思路*: 引入开源项目Photoview，将MediaRoot挂载为其扫描目录，让Photoview自动处理图片相册和视频缩略图等核心功能:contentReference[oaicite:43]{index=43}:contentReference[oaicite:44]{index=44}。在此基础上，针对“散图”“游戏”“其他”分类需求，开发附加模块：例如在Photoview前端额外增加页面读取MediaRoot下所有不在任何相册路径下的图片（任意层级）作为“散图”列表，读取特定扩展名(.exe等)作为“游戏”列表，读取其它文件作为“其他”列表。后台可以利用Photoview的扫描结果（Photoview使用数据库保存媒体元数据和缩略图路径）附加查询非图片/视频文件。*依赖*: Photoview主程序（Go + React）以及数据库(PostgreSQL)；需要了解Photoview源码结构并编写插件或修改源代码。*复杂度*: 高。Photoview代码体量中等（约6k stars，前后端结合），二次开发需熟悉Go后端和TypeScript前端，修改不当可能破坏其现有功能。需要维护自定义改动与上游同步升级。*预估成本*: 开发约需数周研读和实现改动，测试需要搭建数据库和大量媒体文件验证。硬件成本主要为运行PostgreSQL和Photoview服务的资源占用。*性能/扩展*: Photoview本身针对大量照片做了优化（缩略图缓存+懒加载:contentReference[oaicite:45]{index=45}），性能较有保障。扩展部分（散图/其他）如果处理不当可能拖慢首次扫描（需在海量文件中过滤分类）。但数据库索引有助于搜索和多用户扩展，将来可支持更多功能。*安全/隐私*: Photoview注重私有部署安全（cookie鉴权等）:contentReference[oaicite:46]{index=46}，采用它可继承这些机制；需注意我们自定义的文件操作接口也要符合安全原则（Photoview默认不提供删除功能，需要慎重实现）。合规方面Photoview是AGPL协议，修改后若对外发布需开源代码，不能闭源商用。*团队可达性*: 团队需要Go和前端能力齐备。若现有技术栈不涵盖Go语言，开发调试门槛较高。Photoview社区可以提供一定支持，但定制需求比较小众，需要团队自主解决实现。
  - **方案B：组合FileBrowser或类似工具** – *思路*: 利用FileBrowser等成熟通用文件管理WebUI，做最小改造满足需求。具体做法：运行FileBrowser指向MediaRoot，实现基础的文件浏览、预览、删除等功能（FileBrowser本身提供文件删除/移动操作UI和权限控制:contentReference[oaicite:47]{index=47}）。然后在其界面或通过配置，将MediaRoot下各子文件夹显示为“相册”（FileBrowser本就是以目录列表形式呈现，可以直接视每个文件夹为相册入口，只是没有封面缩略图；可考虑给相册文件夹放置一张封面图文件例如folder.jpg，让FileBrowser显示为缩略图代表）。“散图”与“视频”聚合的需求则较难通过配置实现——可能的折衷是在MediaRoot根目录下增设虚拟文件夹或使用搜索过滤功能：例如FileBrowser支持按扩展名搜索，用户点击“视频”入口实际执行一次扩展名为.mp4/.mkv等的搜索，结果列表相当于全局视频列表；“散图”类似按目录深度筛选（FileBrowser暂无直接支持，可能需要修改源码）。*依赖*: FileBrowser可执行文件（Go编译产物），可选其源代码（Apache许可）进行修改；另外可以利用FileBrowser的Hook或二次开发接口实现定制行为。*复杂度*: 中等偏高。直接使用FileBrowser很简单，但为了达到项目的独特UI/分类要求，需对其源码进行非典型改造或编写辅助脚本，复杂度上升。FileBrowser项目结构较清晰但目前维护有限，需自力更生实现新功能。*预估成本*: 若尽量不改源码，开发成本低（天级别就可部署基本功能），但用户体验和需求吻合度差；若进行源码定制实现聚合视图等，估计1-2周开发调试。无需额外数据库，资源开销低。*性能/扩展*: FileBrowser针对一般文件操作性能良好，Go编写效率高。它按需读取目录，不会一次加载所有文件，因此在大目录下翻页性能还可以。但缺少专门为海量媒体优化的缓存机制，大量图片目录可能出现浏览器负担（需浏览器逐个生成缩略图，可能闪烁或占用带宽）。扩展性有限，不易加入更高级的媒体处理（如自生成视频预览）。*安全/隐私*: FileBrowser有用户管理和权限控制，可以保护访问。但若不启用登录，默认本地使用也还安全。操作限制可通过其配置规则实现避免越权。许可Apache2.0非常宽松，对自定义发行无限制。*团队可达性*: 团队需懂Go来定制，但修改量不大也可接受；前端是已有的，避免了JS开发。总的来说技术要求低于方案A，但成果在用户体验契合度上打折扣，需要团队在UI/功能取舍上妥协。
  - **方案C：自主开发定制 WebUI** – *思路*: 从零或基于轻量框架构建专门满足需求的Web应用。后端采用熟悉的语言（例如Python的Flask/FastAPI，或Node.js的Express）扫描MediaRoot目录树，分类收集文件信息。启动时生成或更新一个内存索引/数据库：标记哪些是相册（叶子图片目录）、哪些图片属散图、列出所有视频文件等。并调用图像库与FFmpeg生成缩略图缓存（图片缩略图用Pillow按较小分辨率存储；视频缩略图用FFmpeg提取4帧拼合而成:contentReference[oaicite:48]{index=48}）。前端使用现代JS框架（如React/Vue）实现SPA：初始加载5个分类卡片，点击后通过路由切换视图（不刷新页面）。相册视图下，请求后台获取相册内图片列表及缩略图路径，前端以网格显示缩略图，支持点击overlay查看；视频视图下，后台提供所有视频列表及缩略图路径，前端以平铺卡片显示。散图视图类似相册的平铺。游戏/其他视图则简单列出文件名及图标（可使用文件类型通用图标）。提供顶层全局搜索框，键入时调用后台按文件名关键字匹配MediaRoot索引，返回所在相册或文件位置。文件管理操作通过专门API实现：如DELETE请求执行删除，MOVE请求带目标路径参数实现移动，操作前由前端弹窗确认。实现操作日志持久化（文本日志或简单SQLite记录）。*依赖*: 后端依赖：Python 3.x环境，Flask或FastAPI框架，Pillow库，FFmpeg可执行文件；前端依赖：React/Vue框架及组件库（如Ant Design/Material UI用于布局美化），以及第三方JS库（如PhotoSwipe用于图片展示、Video.js用于更友好的视频播放器控件）。*复杂度*: 中等偏高。需要前后端协同开发，但可完全按照需求裁剪实现。缩略图生成和文件扫描逻辑需仔细优化以免卡顿（可在后台启动时异步完成，不阻塞前端初始加载）。前端需要实现一定复杂度的交互（如懒加载列表、Overlay组件、拖动全屏等），选择成熟组件能降低难度。*预估成本*: 核心开发约需3-5周：后端扫描与API 1周，缩略图生成和缓存2-3天，前端界面搭建2周左右，联调测试1周。可迭代交付：先实现基础浏览->再加搜索和管理。硬件成本仅为运行Python服务的消耗，负载较低（扫描和缩略图生成主要耗时发生在首次/后台）。*性能/扩展*: 得益于定制，可有针对性优化。如首次启动可增量扫描，加快可用度；缩略图缓存磁盘保存避免重复生成；使用浏览器原生能力显示媒体（性能接近本地播放）。在数万文件规模下可能遇到索引和UI的挑战，但可引入分页、虚拟滚动技术缓解。扩展方面，架构灵活，可后续增加例如标签归类、简单的图像识别标记等功能，无框架掣肘。*安全/隐私*: 本方案完全本地化运行，任何媒体信息不外传云端:contentReference[oaicite:49]{index=49}。只要后端接口做好路径校验（防止路径穿越访问MediaRoot外部），安全性有保障。删除等敏感操作均需确认，且可选用回收站机制，降低人为失误风险。依赖的第三方库多为宽松许可(MIT/Apache)，不存在法律隐患；需注意若捆绑FFmpeg，要遵守其LGPL/GPL开源义务（例如提供许可证文本）。*团队可达性*: 团队完全可以使用擅长的语言开发，避免跨语言障碍。Python生态对Windows支持良好，调试便利；前端栈需要有Web开发经验，但React/Vue文档完善、社区活跃，可查找实例组件实现类似功能，加上参考先例UI，开发风险可控。整体而言，此方案开发工作量最大，但产出将最贴合需求且自主可控。

  - **决策矩阵**（主要决策因素及各方案评分）：

    | 决策标准                   | 权重 | 方案A: Photoview定制 | 方案B: 基于FileBrowser | 方案C: 自主开发 |
    | -------------------------- | ---- | ------------------- | --------------------- | -------------- |
    | **功能契合度**             | 30%  | 中等（需拓展非媒体部分）    | 较低（仅基础浏览，无相册聚合） | **高**（完全按需实现） |
    | **开发复杂度**             | 25%  | 高（二次学习Photoview架构） | 中等（改源码有难度）        | 中等偏高（全栈开发）    |
    | **性能与可扩展性**         | 20%  | 高（成熟优化, 但绑定PG数据库） | 中（一般文件操作性能，可扩展有限） | **高**（定制优化, 可扩展） |
    | **维护成本**               | 15%  | 中（需跟踪上游更新，AGPL约束） | 中（项目维护停止, 需自担后续） | **中**（自行维护全部代码） |
    | **许可与合规风险**         | 10%  | 较高（AGPL需开源衍生）     | 低（Apache2.0宽松）        | **低**（依赖MIT/Apache库） |
    | **总分（综合考虑）**       | 100% |  (~6.8/10)          |  (~6.5/10)            | **(~8.5/10)**  |

    （评分说明：方案C在功能满足和长远灵活性上占优势，略抵消了其开发工作量偏大的劣势，综合得分最高。）

  - **推荐方案与放弃理由**：综上，**推荐采用方案C自主管理开发**，即使用现有Web框架和库从头搭建定制WebUI。这一方案虽然前期开发投入最大，但能够彻底满足项目对UI呈现和功能定制的细致要求，且不存在外部协议桎梏，后续维护演进自主性强。参考Photoview的经验可大幅降低技术风险（例如沿用其缩略图和懒加载策略:contentReference[oaicite:50]{index=50}、FFmpeg集成方法等），而无需受制于Photoview的复杂架构和AGPL许可限制:contentReference[oaicite:51]{index=51}。相比之下，**方案A（Photoview二次开发）**放弃的理由是：引入一个复杂的第三方系统再做改造，学习和修改成本高，特别是Photoview偏重照片功能，对“其他文件”“游戏”的支持空白，强行改造成混合媒体管理工具可能得不偿失。此外AGPL许可要求开源发布修改代码，若项目仅内部使用影响不大，但将来若闭源分发不利。**方案B（FileBrowser方案）**放弃的理由：虽然初始能快速部署，但无法实现项目独特的分类视图和缩略图需求，勉强定制会导致代码维护困难且体验不理想。FileBrowser目前也不活跃，不指望其官方新增功能:contentReference[oaicite:52]{index=52}。综合衡量，方案C的自主开发在本地项目场景下最为稳妥，其投入与回报（满足需求程度）比最高。

- 外部依赖清单：

| 名称                 | 版本 / 最近更新    | 许可        | 速率/配额    | 兼容性                   | 弃用/维护风险       | 备注                       |
| -------------------- | ------------------ | ----------- | ----------- | ------------------------ | -------------------- | -------------------------- |
| **Python 3.x** (后端运行环境) | 3.11.x（2023年发布更新） | PSF许可证   | 本地运行，无调用配额 | Windows/macOS/Linux均支持；需安装解释器或打包exe | 极低：Python属长期支持语言 | 用于后端服务逻辑，如使用Flask需Python环境 |
| **Flask** (Web框架)   | 2.3.x（2023-04发布） | BSD-3-Clause | 无（本地框架） | 与Python 3.x兼容良好；Windows下正常运行 | 低：Flask社区活跃，更新稳定 | 后端路由与API框架；可换FastAPI类似框架 |
| **Pillow** (图像处理) | 10.0.0（2024-07发布） | MIT (MIT-CMU) | 无          | 纯Python库，多平台支持（提供Windows预编译轮子） | 低：成熟库维护良好       | 用于生成图片缩略图、拼接相册4宫格封面等 |
| **FFmpeg** (视频处理) | 6.0（2023-02发布）   | LGPL-2.1/GPL-3（组件不同） | 无（本地CLI） | 提供Windows静态编译版本；调用命令行工具 | 低：开源项目非常活跃，但需注意版本变化 | 用于提取视频帧，需随应用分发或提示用户安装 |
| **React** (前端框架)  | 18.3.0（2022-10发布） | MIT         | 无          | 浏览器支持Chrome/Edge/Firefox等现代浏览器；IE不支持 | 低：Meta维护，社区庞大    | 实现SPA前端组件，优化交互体验 |
| **Ant Design** (UI组件) 或类似 | 5.x（持续更新）    | MIT         | 无          | 与React兼容；对Chrome等浏览器支持好 | 中：组件库频繁更新需关注版本兼容 | 用于快速构建布局、响应式栅格、Modal等UI元素 |
| **Video.js** (HTML5播放器) | 8.x（2023更新）    | Apache-2.0  | 无          | 支持Chrome/Firefox/Edge等；移动端兼容亦可 | 低：社区维护良好         | 提供定制视频控件界面及格式扩展支持，增强浏览器原生播放器体验 |
| **PhotoSwipe** (图片查看组件) | 5.3.7（2023-06）  | MIT         | 无          | 依赖浏览器，兼容主流环境    | 低：活跃维护           | 用于图片Overlay画廊效果（手势缩放、滑动） |
| **SQLite** (嵌入式数据库)**可选** | 3.43.0（2023-09） | 公有领域    | 无          | 跨平台C库，Python内置支持 | 极低：非常成熟稳定       | 备选用于存储媒体索引和日志。若数据量不大也可用简单JSON替代 |

*(注：上述依赖均为本地运行库/工具，无第三方在线API调用，因此无外部调用配额限制。重点关注兼容性的是FFmpeg：需要提供Windows版并处理好PATH。在发行时需遵守FFmpeg的LGPL/GPL许可条款，比如如果使用其GPL组件须开源工具整体代码或改用LGPL配置。其余依赖多为宽松MIT/BSD许可，对项目分发无额外约束。)*

- 风险与不确定性：
  1. **文件删除操作的安全性风险**（影响高×概率中）：若实现不当，可能发生误删重要文件或删除MediaRoot外部文件。尤其批量操作或用户误点确认都有可能造成数据丢失。*缓解策略*: 严格限制后端删除逻辑仅作用于MediaRoot内部路径（路径规范化检查）；所有删除/移动前在前端弹出醒目确认对话，并提示影响范围；考虑实现“软删除”将文件移入回收站文件夹而非永久删除，用户需要进一步操作才能清空回收站【项目要求中提及】。另外，对危险操作记录日志，便于事后审计和手工恢复。
  2. **大规模媒体库的性能风险**（影响中高×概率中）：当MediaRoot包含成千上万文件时，初次扫描和缩略图生成可能耗时较长，前端加载大量缩略图也可能出现卡顿。如果实现不佳，用户体验可能下降甚至页面崩溃。*缓解策略*: 采用增量扫描（应用启动时先快速列出顶层目录，逐步后台生成各相册缩略图并更新UI，提升感知速度）；对缩略图和索引进行持久缓存（避免每次重启重复计算，对于已生成的缩略图存在磁盘缓存，数据库保存文件列表和上次修改时间）；前端严格使用懒加载和分页技术，控制同屏DOM元素数量；必要时，在极端大列表下引入虚拟列表（只渲染可见区域）。设计压力测试（如模拟1万张图片、百部视频）作为Spike验证性能瓶颈并优化。【参考Photoview经验：其缩略图生成在后台自动完成，照片仅在屏幕可见时加载【38†L92-L100】。】
  3. **视频格式兼容性及播放性能不确定性**（影响中×概率中）：浏览器支持的音视频格式有限（如Chrome支持MP4/H.264、WebM等，但不直接支持某些AVI/MKV封装或HEVC编码）。如果用户媒体包含浏览器无法原生解码的格式，可能无法播放或只黑屏。有些超高码率或高帧率4K视频，即使浏览器支持格式也可能因硬件限制掉帧。*缓解策略*: 项目启动时或扫描时检测常见不兼容格式（扩展名/编码信息），在UI上对此类文件标记特殊图标或提示，例如提示“浏览器无法播放，建议使用外部播放器”或提供一键用系统默认播放器打开的按钮。对于兼容但性能吃紧的视频，可提供降低分辨率播放的选项（比如引入ffmpeg.js在浏览器做实时转码，代价较高，不作默认）或者提醒用户在本地播放器中观看以获得硬件解码优势。由于项目本身不提供云端转码服务，需在文档中明确性能取决于PC硬件，建议用户在高负载场景下准备较高性能的CPU/GPU。
  4. **开发工作量和进度风险**（影响中×概率低）：方案C涉及前后端多方面开发，个人独立完成可能遇到任务堆叠或未知难题（例如某前端组件不如预期，需要另找解决方案）。若估计不足，可能延误里程碑。*缓解策略*: 采用迭代式开发，先实现基本可用版本（基础浏览+删除），再逐步完善高级功能（搜索、软删除等），确保核心价值得以早期验证。过程中及时梳理未决问题（见下文）并尽早Spike实验，降低不确定性。利用开源社区资源（如遇技术难点可参考类似项目实现或向社区请教）。在任务管理上，细分任务并设定优先级，聚焦P0需求优先完成验收。
  5. **依赖组件和许可风险**（影响较低×概率低）：虽然我们选用的依赖多为成熟稳定库，但仍需注意版本更新带来的变化。例如Ant Design等UI库大版本升级可能影响已有界面，需要额外适配；FFmpeg在未来版本参数行为变动可能影响缩略图生成脚本。另一个层面，若未来需要对外发布此工具，需满足所有开源组件的许可要求（例如FFmpeg的GPL部件）。*缓解策略*: 锁定经过验证的依赖版本用于当前开发，避免随意升级；关注社区公告和更新日志，及时兼容必要的安全更新。法律上，准备好一个关于依赖许可的说明文档，分发时附带各OSS库的LICENSE文件，确保合规（:contentReference[oaicite:53]{index=53}Video.js等Apache/MIT库仅需保留版权声明）。由于本项目主要自用，许可风险总体可控。

- 最小验证计划（Spike）：
  - **目标与判定阈值**：验证大批量媒体缩略图生成和懒加载方案在典型PC上可行，确保在含500张图片、50段视频的模拟媒体库中，首页和各分类页面加载时间可接受（目标：首页加载<3秒，进入图片列表页首屏内容<2秒），滚动浏览不卡顿；同时验证FFmpeg提取缩略图的方法效果和性能（目标：单个视频4帧拼图缩略图生成<2秒）。
  - **步骤**：
    1. **准备测试集**：收集约500张各尺寸图片、50个短视频文件（不同格式，如MP4, MKV各若干）放入一个临时MediaRoot，构造若干子文件夹模拟相册，部分图片散落在根目录，视频散落不同子目录。
    2. **编写缩略图生成脚本**：使用Python脚本调用Pillow将图片统一生成缩略图(例如长边不超过300px)，记录耗时总计；调用FFmpeg对随机3个视频提取4帧并用ImageMagick或Pillow拼合2×2图，分别记录每个视频处理耗时。验证缩略图文件大小及清晰度是否满意。
    3. **搭建简易前端页面**：编写一个HTML测试页面，不依赖框架，直接以<img>标签列出上述缩略图（例如一次性生成一个包含500张缩略图的图片墙页面），对<img>设置`loading="lazy"`属性或使用Intersection Observer懒加载。在页面顶部添加简单搜索输入框，采用JS在前端对缩略图元素过滤展示，以模拟搜索功能效果。
    4. **测试加载表现**：在Chrome浏览器打开该测试HTML，测量页面初始加载时间（可使用开发者工具网络面板观察首次渲染时间）；快速滚动页面，观察是否出现明显延迟或图片大量未加载的空白。然后尝试在搜索框输入一个存在的文件名片段，观察过滤结果响应速度。记录浏览器内存占用峰值。
    5. **记录结果与判断**：如果初始页面在3秒内基本渲染（哪怕未加载所有图片但布局出现）且滚动过程中图片陆续加载顺畅，说明懒加载策略有效（判定通过）。缩略图生成方面，若500图处理在可接受时间（例如<30秒）完成且FFmpeg单视频缩略<2秒，表示后台预处理性能可接受。若结果不达标（如浏览器明显卡顿或缩略图生成极慢），分析瓶颈（可能是图片过大、IO慢或懒加载未真正发挥作用），调整方案重试，如降低缩略图分辨率、引入分页等，再次验证直到达标。
  - **产出与验收**：该Spike将输出一份测试报告（包括所用测试集规模、各项性能数据和发现的问题），提供关键参数选型依据（例如建议缩略图尺寸、视频帧截取策略）。通过验收标准：报告显示在目标规模下性能指标满足或经过调整后满足预期，并给出进一步开发采用的参数（如缩略图长边像素、懒加载阈值等)。

- 评测与验收标准：
  - **功能完整性**：逐项验收所有要求的功能是否实现：
    - 图片相册列表：正确识别MediaRoot下的“叶子图片目录”为相册（目录直接含图片且其子目录/后代目录不再含图片；父目录仅作容器不重复计为相册），展示名称和4宫格封面缩略图；封面内容随机且相册固定（每次打开不应变动，除非相册内容变更）；相册内图片打开Overlay浏览，能够前后切换浏览同一相册全部图片，且在窗口各种尺寸下图片完整可见、无黑边拉伸现象。
    - 散图列表：列出MediaRoot内所有不在任何相册路径下的图片（任意层级，包含根目录及非相册嵌套目录），支持“一键归档”操作将这些图片移动至预设_unsorted文件夹（操作后相应图片从散图列表消失且实际文件移动成功）。验收标准：执行归档后目标文件夹出现这些文件，源位置消失，日志记录动作；若无散图可处理，UI应禁用归档按钮。
    - 视频列表：汇总显示MediaRoot内所有视频文件（支持的扩展名列表覆盖常见格式，例如mp4/mkv/avi等），每个视频项显示文件名和2×2缩略图；点击打开Overlay直接播放视频第一帧开始，用户可正常播放/暂停、调整音量和切换全屏。验收指标：常见格式(mp4/h264)视频可直接播放【无黑屏】；播放控制响应，无明显延迟；4K分辨率视频在测试电脑上全屏播放流畅（帧率≥30fps，如果硬件不支持更高帧率则不强求）。
    - 游戏列表：扫描MediaRoot下扩展名为.exe、.lnk等可执行文件或文件夹标记为“游戏”的项目，列出名称（可使用文件夹名或文件名）和对应图标（如统一使用游戏手柄图标表示此类别）。点击游戏项，默认行为可以是弹出提示“此类文件暂不支持直接运行”。验收：能正确罗列出MediaRoot内的游戏文件/目录；暂不要求点击启动，但需要防止误触执行任意可执行文件（即当前实现应不直接运行游戏，以策安全）。
    - 其他列表：列出MediaRoot及子目录中不属于上述分类的所有其他文件，采用列表形式展示文件名、大小、修改日期等基础信息。验收：比如有.docx、.zip等文件，应在“其他”看到；点击操作可以提供下载（浏览器默认行为）或用系统关联程序打开的提示。
    - 搜索功能：在界面明显位置提供搜索框，支持按文件/文件夹名称关键字即时筛选。验收标准：输入3个以上字符时，页面即时显示匹配的相册或文件项，高亮关键词；对大小写不敏感、支持部分匹配（如输入“假期”能匹配文件名“我的假期.mp4”）。搜索结果点击后行为合理：若结果是相册或文件，则进入对应相册或打开Overlay查看文件。
    - 文件操作：针对列表中的文件和相册提供删除和移动操作（UI上可通过右键菜单或按钮）。验收：删除操作需弹出确认对话框显示文件/相册名，确认后执行删除，文件从UI消失且实际从磁盘移除到回收站或彻底删除（按实现而定）；移动操作提供目标选择界面（如目标相册或新建文件夹选项），执行后文件在UI中消失并在新位置可见。所有操作在日志中记录（包括时间、操作类型、目标路径等），日志文件可查阅。
    - **验收标准**：上列功能全部实现且通过手动测试验证；关键路径无明显bug（如浏览图片顺序错误、删除错误文件等）。
  - **性能指标**：
    - 初始页面加载：MediaRoot包含100个相册（各4张封面图）、100张散图、100个视频的情况下，首页5个分类入口卡片在**2秒以内**加载完成:contentReference[oaicite:54]{index=54}（含缩略图呈现）。导航进入某一分类列表（如图片相册列表）耗时**<2秒**出现内容。
    - 滚动和懒加载：在包含1000张图片的相册视图下，向下滚动时页面保持流畅（主流PC上滚动帧率不低于50fps，无明显卡顿）；图片只有在接近视窗时才加载，滚动到某位置时该处图片均已加载完毕。通过Performance工具测量，长列表滚动时浏览器内存占用随已加载图片数量线性增长，无爆增或内存泄漏；在5秒不操作后内存稳定，无持续上涨趋势。
    - 视频播放性能：针对一段2160p（4K）@60fps、码率约20Mbps的本地MP4视频，Overlay播放中CPU占用率不超过50%（利用GPU硬解码），播放过程无音画不同步或明显丢帧现象。若有240fps视频素材，尝试播放至少不崩溃，能以降低帧率的形式正常放映或提前告知硬件不足。视频快进/拖动进度响应时间<1秒，停止播放Overlay关闭释放资源（内存、文件句柄）。
    - 缩略图生成效率：批量测试生成100张图片缩略图+10段视频预览，总耗时应在**1分钟**以内完成（平均每张图<0.2秒，每个视频<5秒包含截图和拼图）。后续增量扫描新文件时，对于已经生成过缩略图的文件不重复处理（判断依据如文件时间戳），验证重复启动应用时不会再次处理未变更的媒体（通过日志或文件哈希核对）。
    - 搜索速度：包含10000项（相册+文件）情况下，搜索在**100毫秒**内返回结果（可以通过在大量模拟数据下测试搜索API或前端过滤的耗时）。前端输入每字符无明显卡顿。
    - **通过阈值**：以上指标经实际测试达到或优于目标值，若个别未达成需有合理解释（如240fps视频硬件无法满帧但已处理降帧提示，视为通过）。
  - **可靠性与异常处理**：
    - 程序运行稳定性：连续运行2小时，执行上百次打开/关闭查看、删除移动等操作无崩溃、内存泄露；监控后台日志无未处理异常输出。
    - 异常场景处理：人为制造一些异常测试，例如MediaRoot在运行中被外部修改（新增或删除文件），系统能在下一次扫描或用户刷新时正确更新列表，不会出现数据库/索引不一致；若缩略图文件丢失或生成失败，前端有默认占位图提示而非死链；视频无法播放时，有明显错误提示但界面可正常关闭退出。
    - 安全检查：尝试构造恶意输入（如通过URL直接请求父目录`..`路径），确认服务器有防护拒绝；前端对文件名中的特殊字符（引号、脚本标签）做了转义，不发生XSS风险。删除移动操作的确认对话准确列出将影响的文件，不会误导用户。
    - **通过阈值**：以上可靠性测试无重大问题。若出现崩溃或数据错误则需修复后再次验收。
  - **可用性与用户体验**：
    - 界面布局在1920×1080、1366×768等不同分辨率下均无明显布局错乱或元素遮挡；在Chrome、Firefox主流浏览器中功能表现一致。界面文本（包括中文文件名）清晰可见无乱码。
    - 操作体验：随机找几张图片和视频，通过提供的UI能方便地找到并打开；整理散图经过确认一步到位；整个操作流程符合用户预期，无需额外阅读说明即可基本使用。收集试用者（若有）反馈意见，满意度达到预期。
    - **通过阈值**：主观评价基本满意，无严重抱怨点。UI交互符合常规习惯（如点击空白处关闭Overlay等实现正确）。

- 合规/隐私/安全要点：
  - **本地隐私**：本系统不上传任何文件或用户数据到互联网，一切媒体内容和操作日志都保存在用户本地:contentReference[oaicite:55]{index=55}。因此符合隐私要求，无需担心GDPR等法规。但需提醒用户自己搭建外网访问（如映射端口）可能带来隐私风险，不属于默认使用方式。
  - **内容安全**：由于是用户私有媒体库，系统不涉足内容审核。然而提供删除工具时需防范误删（见上文风险），这属于用戶操作层面的安全。若将来扩展支持多人访问，则可能考虑基础的权限（目前未在范围内）。
  - **开源许可合规**：采用的第三方库均为宽松开源协议（MIT、Apache、BSD等），对项目发布基本无约束，只需在随附文档中呈现其版权和许可说明。需特别注意FFmpeg：如果选择静态链接GPL组件或者直接打包FFmpeg二进制，严格来说软件整体需遵循GPL发布源码；为避免此义务，可选择动态调用系统FFmpeg或使用LGPL配置的FFmpeg版本。项目本身如不开源发行应尽量避免引入AGPL、GPL等传染性协议库。
  - **安全通信**：默认在本地主机访问，无需加密通信。但如果用户自行开放端口在局域网访问，建议提供选项启用HTTPS（可生成自签名证书）以防流量被窃听篡改，尤其是如果开启了登录验证之类机制。当前本地使用场景下，可忽略此点但在文档中注明外网/公网访问的潜在风险。
  - **可解释性与日志**：系统设计操作日志记录，每项文件变更都有迹可循，符合可审计性需求。如果用户在意，可以通过日志追踪到何时删除了什么文件。这对个人用户主要用于自查误操作，满足基本可追溯性。
  - **数据存储合规**：如实现数据库（SQLite），存储的仅是文件元信息（路径、缩略图路径等）和操作日志，不包含敏感个人信息。确保日志不过度记录用户行为，仅用于故障排查和恢复。
  - **其他法规**：不涉及用户生成内容公开或版权传播，因此与DMCA等无关。用户自行使用时应遵守其所在司法辖区对内容的规定（例如不存储非法内容等），这超出软件责任范围，在用户协议或说明里可简单声明遵循当地法律使用软件。

- 开发影响面：
  - **代码仓库与CI**：项目将新建独立代码仓库，包含前端和后端代码。需要设置基础的CI流程，如测试套件（单元测试后端文件扫描和操作逻辑；前端组件的snapshot测试等）和构建流水线（前端React打包，后端打包为可执行）。由于是本地工具，CI重点在确保不同环境下构建通过（Windows作为主要目标环境）。可考虑GitHub Actions设置Windows Runner自动运行测试和构建。
  - **接口设计**：内部接口主要在前后端间，如REST API定义用于获取文件列表、执行文件操作、搜索等。需设计清晰稳定的API契约，便于未来前端独立升级。接口返回要标准化（如使用JSON，定义错误码等）。此外，还需要处理与FFmpeg和系统文件操作命令的接口，例如调用FFmpeg命令行的封装、调用Windows API（如果有）等部分。
  - **数据管理**：媒体索引和缩略图缓存属于衍生数据，可重建但为性能持久化。需决定是否将这些数据保存在MediaRoot的特殊文件夹（如`.cache`），或在应用自身目录存储。决定方案后，部署和清理都要注意：比如提供功能清除缓存、重建索引。如果使用SQLite数据库文件，也要决定路径（便于用户定位或迁移）。
  - **部署与交付**：开发完成后需要简化用户部署流程。影响方面包括：将前端静态文件和后端打包成一个启动单元。考虑采用PyInstaller将Python+Flask打包为单个EXE，或采用Docker容器（但Windows用户未必习惯Docker）。由于要求“双击bat启动”，可以在发布版中提供Windows批处理脚本（内容为调用Python exe或者启动Flask）并自动打开浏览器http://127.0.0.1:端口。开发上需编写这个启动脚本逻辑，也考虑端口冲突检测、浏览器路径等（使用系统默认浏览器）。
  - **配置与参数**：应用可能需要配置项，例如MediaRoot路径（可从启动参数或配置文件读取），缩略图大小、是否开启某些高级功能等。决定配置管理方式：简易做法是提供config.json或yaml，开发时要实现解析读取。对于普通用户，尽量提供合理默认值并减少配置复杂度。
  - **监控与更新**：本地工具一般无遥测。但为了改进，可加入一个“检查更新”模块（例如GitHub Releases版本检测）提醒用户有新版本。开发上可通过后端去GitHub API查询。但要尊重隐私，可让用户手动触发检查。另外，需准备项目的版本发布日志和升级指南（尤其如果存储结构有变化，需要迁移说明）。
  - **兼容性**：开发中需在Windows环境实际测试，包括不同Windows版本（Win10 vs Win11）。如果考虑部分技术跨平台，亦可在Mac/Linux简单验证核心功能，但重点仍是Windows适配（如路径分隔符、大小写敏感问题、Windows对长路径支持等）。前端方面，需要兼容Chromium内核（Chrome/Edge）及Firefox。IE无需支持。移动端浏览器虽非重点，但响应式做好后，应该在手机上也能基本浏览（不作为验收重点）。
  - **CI/CD**：鉴于项目规模有限，可选择手动发布。但如果要频繁迭代，设置一个持续交付流程有益。例如每次push触发前端构建和后端PyInstaller打包，产出release资产。开发阶段也可以用CI自动运行测试保障核心功能。
  - **开发工具**：团队可能需引入某些开发库影响开发流程，如前端使用TypeScript会引入构建编译环节，需在项目中配置Webpack/Vite等。后端如采用FastAPI可用Pydantic做数据模型，也需注意其版本兼容。这些决定在开发早期就要选定，否则中途切换会影响进度。

- 未决问题：
  1. **“散图”范围界定**：散图按规则定义为“MediaRoot内所有不在任何相册路径下的图片”（不限制深度）。仍需明确“相册路径”的来源与判定（如：是否由相册识别规则自动产出、是否需要可配置的相册根目录、是否需要排除如`_unsorted`/`.cache`/`tmp`等特殊目录）。
  2. **相册嵌套的处理**：如果MediaRoot下存在多级子文件夹，如“旅行/2023夏/1.jpg”，则按“叶子图片目录即相册”口径，相册为“旅行/2023夏”，而“旅行”仅为容器目录。界面上是否需要展示多级结构（容器目录→叶子相册）仍待确认：可选方案包括平铺所有叶子相册，或提供目录层级导航（先进入容器目录再进入叶子相册/子目录）。这方面需求需澄清。
  3. **游戏类别识别**：目前游戏入口“不重点实现”，但仍需基本罗列。需决定识别规则：是以可执行文件（.exe, .bat等）为标志物，还是以特定文件夹命名（如包含“game”字样或配置文件）。可能简单从MediaRoot扫描`.exe`文件，如果位于独立文件夹则以文件夹名作为游戏项。如果一个文件夹里有多个exe，可能列出多个或仅识别主程序（或以体积最大者）。这些细节尚不明确，可能需要根据实际MediaRoot结构调整，或暂由用户手工整理游戏目录确保每游戏一个文件夹。验收前需确定方案并在文档中注明假设。
  4. **软删除实现**：是否实现回收站功能，以及具体策略未最终决定。如果实施，需考虑回收站位置（MediaRoot下某特定文件夹还是系统回收站）、回收站清理机制（自动/手动清空）。若不实现软删除，则日志加确认已基本满足防误删要求，但从安全性看软删除较稳妥。需权衡开发量和用户需求紧迫性决定。
  5. **多用户访问和权限**：目前假定单用户在本机使用，无登录机制。但如果将来用户希望局域网分享给他人访问，是否要增加账户认证、只读权限等？这超出当前范围，但可能是潜在需求（例如家庭共享图库）。在架构设计时可留意不要堵死扩展可能性，例如后端API层设计可兼容日后加鉴权。当前是否实现至少一个简单密码保护（防止局域网他人未经许可访问）需要确定。
  6. **浏览器支持范围**：默认聚焦Chrome。如有用户使用Firefox、Safari，需要验证核心功能（尤其视频播放不同浏览器支持的格式不同，Safari不支持WebM等）。若必须支持Safari/macOS，需要FFmpeg预先转码某些格式或提示用户安装扩展。需明确环境假设：如果仅Windows/Chrome，则问题不大，若扩展环境则工作量增加。
  7. **MediaRoot动态更新**：如果应用运行期间有文件被外部程序新增、删除，系统如何感知？是启动时扫描一次静态列表，还是实现文件系统监听（Windows的FileSystemWatcher等）自动更新UI？监听可提高实时性但增加复杂度和资源占用。可能先采用手动刷新或定时扫描策略。这个实现细节待根据性能余裕和用户体验要求决定。
  8. **缩略图生成策略**：视频帧的选择方法和封面拼接样式是否需要更智能？当前方案简单随机或定间隔4帧。如果效果不好（比如全是黑场），可以考虑FFmpeg的`select=gt(scene,0.xxx)`滤镜找场景变化:contentReference[oaicite:56]{index=56}。同时相册4图封面是否要裁剪成正方形以适应布局？可能需要一些UI调整。此属优化层面的问题，可在实现过程中微调。
  9. **潜在额外需求**：项目描述之外，用户可能需要的小功能，如：图片旋转、视频截帧下载、幻灯片播放、按日期排序等。目前不在范围，但开发时可留有扩展空间，如设计模块化的viewer组件，将来可以插入新按钮。需要在不影响当前进度的前提下尽量编写扩展友好的代码。

- 参考资料（Evidence Table）：

| 主张 / 结论                                       | 证据摘录                                                       | 来源标题                     | 发布方          | 链接                                                         | 内容日期       | 访问日期     | 可信度    |
| ---------------------------------------------- | ---------------------------------------------------------- | ---------------------------- | --------------- | ------------------------------------------------------------ | -------------- | ---------- | -------- |
| Photoview按文件夹组织相册，自动扫描更新缩略图          | “media is then automatically organized based on the file structure, **directories will become albums**… It will automatically rescan for new media”:contentReference[oaicite:57]{index=57} | Photoview（官方网站）           | Photoview开源项目 | https://photoview.github.io/                                    | 2023-01-10?*   | 2025-12-12 | 高      |
| Photoview使用FFmpeg处理视频，缩略图懒加载提升性能       | “**Ffmpeg is used** under the hood to convert videos… Thumbnails are automatically generated and photos first load when they are visible on the screen.”:contentReference[oaicite:58]{index=58}:contentReference[oaicite:59]{index=59} | Photoview（官方网站）           | Photoview开源项目 | https://photoview.github.io/                                    | 2023-01-10?*   | 2025-12-12 | 高      |
| Photoview完全本地部署，确保隐私数据不外泄               | “Your media is valuable, with Photoview **nothing leaves your server**.”:contentReference[oaicite:60]{index=60} | Photoview（官方网站）           | Photoview开源项目 | https://photoview.github.io/                                    | 2023-01-10?*   | 2025-12-12 | 高      |
| FileBrowser提供指定路径的文件Web界面管理               | “install it on your server, direct it to a path and access your files through a nice web interface.”:contentReference[oaicite:61]{index=61} | File Browser Home            | FileBrowser开发者 | https://filebrowser.org/                                        | –（持续更新）    | 2025-12-12 | 中      |
| FileBrowser已进入维护模式，新功能不再增加               | “**Warning**: This project is on maintenance-only mode.”:contentReference[oaicite:62]{index=62} | File Browser Home            | FileBrowser开发者 | https://filebrowser.org/                                        | 2023-09-01?*   | 2025-12-12 | 中      |
| Files Gallery支持实时筛选和快速加载缩略图              | “**Sort and filter files** in real-time by name, type… **Fast Loading** … caching of preview images”:contentReference[oaicite:63]{index=63}:contentReference[oaicite:64]{index=64} | Files – Single‑file PHP app  | Photo.gallery团队 | https://www.files.gallery/                                      | 2025-01-05     | 2025-12-12 | 中      |
| Jellyfin功能全面，GPL许可需开源修改                     | “Jellyfin enables you to **collect, manage, and stream your media**… free-software entertainment system”:contentReference[oaicite:65]{index=65}；“Jellyfin is Free Software, licensed under the **GNU GPL**… as long as your changes are licensed the same way.”:contentReference[oaicite:66]{index=66} | The Free Software Media System (Jellyfin) | Jellyfin社区    | https://jellyfin.org/                                          | 2025-10-10     | 2025-12-12 | 高      |
| Lazy Loading 推迟非关键资源加载以减少初始加载时间        | “Lazy loading… load these only when needed. It’s a way to shorten the critical rendering path, which translates into **reduced page load times**.”:contentReference[oaicite:67]{index=67} | Lazy loading – Performance   | MDN Web Docs    | https://developer.mozilla.org/en-US/docs/Web/Performance/Guides/Lazy_loading | 2025-11-04     | 2025-12-12 | 高      |
| FFmpeg 常用于从视频截取缩略图                          | “**FFmpeg can capture images from videos** that can be used as thumbnails… Most common ways… are captured in the FFmpeg Wiki.”:contentReference[oaicite:68]{index=68} | Meaningful thumbnails for a Video using FFmpeg (Q&A) | SuperUser论坛   | https://superuser.com/questions/538112/                       | 2013-01-18^    | 2025-12-12 | 中      |
| Video.js 采用 Apache2.0 许可，可自由用于商业或开源项目     | “Video.js is licensed under the **Apache License, Version 2.0.**”:contentReference[oaicite:69]{index=69} | Video.js – GitHub           | Brightcove公司   | https://github.com/videojs/video.js                            | 2013-05-09     | 2025-12-12 | 高      |

*(注:* 标注日期为近似发布日期或资料更新日期；^ SuperUser引述FFmpeg Wiki内容虽老旧但原理通用，经近期验证仍适用。以上资料均通过官方文档或业内知名平台获取，可信度高。)*

[[1]](https://photoview.github.io/#:~:text=%2A%20) [[4]](https://photoview.github.io/#:~:text=Syncs%20with%20file%20system) [[5]](https://photoview.github.io/#:~:text=%2A%20) [[24]](https://photoview.github.io/#:~:text=%2A%20) [[26]](https://photoview.github.io/#:~:text=%2A%20) Photoview

[https://photoview.github.io/](https://photoview.github.io/)

[[2]](https://www.files.gallery/#:~:text=Sort%20and%20Filter) [[15]](https://www.files.gallery/#:~:text=Files%20is%20a%20single,audio%2C%20documents%20and%20text%20files) [[16]](https://www.files.gallery/#:~:text=Sort%20and%20Filter) [[17]](https://www.files.gallery/#:~:text=Single,gallery%20of%20files%20and%20folders) [[18]](https://www.files.gallery/#:~:text=Sort%20and%20filter%20files%20in,name%2C%20type%20or%20specific%20properties) [[19]](https://www.files.gallery/#:~:text=Instructions) [[20]](https://www.files.gallery/#:~:text=Image%20Formats) [[21]](https://www.files.gallery/#:~:text=Video) [[22]](https://www.files.gallery/#:~:text=Fast%20Loading) [[23]](https://www.files.gallery/#:~:text=License) Single-file PHP file manager, file sharing, file browser and photo gallery | Files

[https://www.files.gallery/](https://www.files.gallery/)

[[3]](https://developer.mozilla.org/en-US/docs/Web/Performance/Guides/Lazy_loading#:~:text=Lazy%20loading%20is%20a%20strategy,into%20reduced%20page%20load%20times) Lazy loading - Performance | MDN

[https://developer.mozilla.org/en-US/docs/Web/Performance/Guides/Lazy_loading](https://developer.mozilla.org/en-US/docs/Web/Performance/Guides/Lazy_loading)

[[6]](https://filebrowser.org/index.html#:~:text=File%20Browser%20provides%20a%20file,through%20a%20nice%20web%20interface) [[7]](https://filebrowser.org/index.html#:~:text=it%20can%20be%20used%20to,through%20a%20nice%20web%20interface) [[8]](https://filebrowser.org/index.html#:~:text=Warning) File Browser

[https://filebrowser.org/index.html](https://filebrowser.org/index.html)

[[9]](https://jellyfin.org/#:~:text=Jellyfin%20enables%20you%20to%20collect%2C,system%2C%20bells%20and%20whistles%20included) [[12]](https://jellyfin.org/#:~:text=Jellyfin%20is%20Free%20Software%2C%20licensed,are%20licensed%20the%20same%20way) [[13]](https://jellyfin.org/#:~:text=Jellyfin%20enables%20you%20to%20collect%2C,system%2C%20bells%20and%20whistles%20included) [[14]](https://jellyfin.org/#:~:text=Open%20Source%20Initiative) The Free Software Media System | Jellyfin

[https://jellyfin.org/](https://jellyfin.org/)

[[10]](https://superuser.com/questions/538112/meaningful-thumbnails-for-a-video-using-ffmpeg#:~:text=FFmpeg%20can%20capture%20images%20from,captured%20in%20the%20FFmpeg%20Wiki) [[11]](https://superuser.com/questions/538112/meaningful-thumbnails-for-a-video-using-ffmpeg#:~:text=But%2C%20I%20don%27t%20want%20to,FFmpeg%20to%20capture%20scene%20changes) jpeg - Meaningful thumbnails for a Video using FFmpeg - Super User

[https://superuser.com/questions/538112/meaningful-thumbnails-for-a-video-using-ffmpeg](https://superuser.com/questions/538112/meaningful-thumbnails-for-a-video-using-ffmpeg)

[[25]](https://stackoverflow.com/questions/31425658/videojs-player-free-or-paid-software#:~:text=video.js%20,you%20can%20use%20the) video.js - videoJS player free or paid software

[https://stackoverflow.com/questions/31425658/videojs-player-free-or-paid-software](https://stackoverflow.com/questions/31425658/videojs-player-free-or-paid-software)

[[27]](https://github.com/videojs/video.js#:~:text=Video,Sponsorship) Video.js - open source HTML5 video player

[https://github.com/videojs/video.js](https://github.com/videojs/video.js)
