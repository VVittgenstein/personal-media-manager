# Compact — T-20251212-act-007-fileops-ui

## Scope
- Subtask: `T-20251212-act-007-fileops-ui`（实现前端删除/移动交互与确认弹窗）
- Type: build, Priority: P0, Lane: now
- Dependencies: `T-20251212-act-007-fileops-api`、`T-20251212-act-004-category-views`（已完成）
- Acceptance (record.json):
  - 在列表项提供删除/移动按钮
  - 操作前弹出二次确认并显示源/目标
  - 操作后刷新列表与索引
  - 失败/越界错误展示清晰提示

## Changes（代码落点）
- `frontend/spa/app.js`
  - 新增 `POST /api/delete`、`POST /api/move` 对接（preview → confirm 两段式确认）
  - 新增 FileOps Modal（Delete/Move）：展示源/目标/基础 stat 信息，Esc 关闭，Ctrl/Cmd+Enter 提交
  - 在 Albums / Scattered / Videos / Games / Others 的列表项加入 Move/Delete 入口
  - 操作成功后对当前视图触发 `?refresh=1` 拉取，刷新列表并重建索引
- `frontend/spa/styles.css`
  - 新增 modal 样式与列表项 hover/focus 操作按钮样式
  - 为按钮补充 `btn--sm` / `btn--danger` 变体

## Behavior（用户可见）
- Delete
  - 点击 Delete → 先请求 preview 获取 `confirm_token` 与 `preview{src_rel_path,is_dir,size_bytes,mtime_ms}` → 在弹窗显示确认信息 → 再发 confirm 执行删除
- Move
  - 点击 Move → 输入 Destination（相对 MediaRoot）→ 自动 preview 校验并显示目标与 stat → 再发 confirm 执行移动
  - 支持勾选 `Create parents`：对应后端 `create_parents=true`
- Errors
  - 弹窗内展示 `error.code + error.message`，并对常见错误（如 `SANDBOX_VIOLATION`、`DST_EXISTS`、`DST_PARENT_MISSING`、`STALE_CONFIRM_TOKEN`）给出额外提示文案

## Notes / Limits（显式边界）
- 前端不做复杂路径合法性判断：以服务端校验结果为准（越界/冲突等直接回显错误）
- 硬删除：UI 仅对接后端 `delete`（回收站/软删除不在本 subtask）

## Self-test（本次未在容器内执行）
- 建议：启动后端后，在各视图中对文件执行 Move/Delete，确认：
  - preview/confirm 流程可用、错误提示清晰
  - 操作成功后列表与计数随 `?refresh=1` 更新
