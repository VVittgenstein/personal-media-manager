# Compact — T-20251212-act-004-spa-shell

## 1) Scope 对齐（来自 record.json）
- Subtask: `T-20251212-act-004-spa-shell`（搭建 SPA 首页与 5 入口同页切换框架）
- Priority/Lane: `P0` / `now`
- Depends on: （无）
- Acceptance:
  - 首页显示 Images/Scattered/Videos/Games/Others 5 张入口卡片
  - 点击入口在同一页面切换视图，不触发全页跳转
  - 前进/后退/刷新保持当前视图与上下文
  - 不同窗口尺寸下布局稳定且可用

## 2) Interface / 行为变更（影响下游对接）
- 新增 WebUI 静态入口（由同一后端进程提供静态资源）：
  - `GET /`：SPA 首页（5 卡片入口）
  - `GET /images` / `GET /scattered` / `GET /videos` / `GET /games` / `GET /others`：同页切换路由（支持刷新直达）
  - `GET /app.js` / `GET /styles.css`：静态资源

## 3) 已确认事实（代码 + 自测覆盖）
- 自测命令：`python3 -m unittest -q` → `OK`
- 服务端回退：
  - `GET /` 与 `GET /images` 均返回 `index.html`（`backend/api/tests/test_server.py` 覆盖）

## 4) 实现事实快照（实现要点）
- 路由与状态：
  - 前端使用 History API（`pushState` + `popstate`）实现同页切换；刷新按 `location.pathname` 恢复当前视图
  - 记录每个 route 的 `scrollY`（内存 + `sessionStorage`）以减少“上下文”丢失
- UI 布局：
  - 首页 5 卡片自适应 grid；顶部导航在窄屏可横向滚动；整体响应式在不同窗口宽度下保持可用
- 后端静态托管：
  - `backend/api/server.py` 对非 `/api/*` 请求优先尝试静态文件；对无扩展名路径（如 `/images`）回退到 `index.html`

## 5) 显式限制 / 风险 / TODO（未在本 Subtask 内解决）
- 5 个分类视图目前为占位壳；具体列表/网格与 API 对接由 `T-20251212-act-004-category-views` 实现
- 未引入前端构建链（无打包/压缩）；以纯静态文件为主
