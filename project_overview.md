我的目标是做一个运行在 **Windows 本地**的个人媒体库 WebUI。

因为我电脑里存放资源的文件很多、层级也比较乱，用文件资源管理器找东西非常费劲。我想做一个Webui工具：**双击一个 bat 启动后端服务并自动打开浏览器**，让我能在网页里更方便地浏览这些资源，并进行必要的整理（删除/移动）。图片查看器与视频播放器中，媒体应在**保持宽高比不变**的前提下，**按可用显示区域最大等比缩放**（默认完整可见，不允许拉伸或裁切；当宽高比不一致产生空白时，用同一媒体做背景填充以消除黑边）。

### 1. 运行方式与基本设定

- 这是一个**本地 WebUI**：在我电脑上运行，不需要上传到云端。
    
- 我会指定一个“媒体根目录”（MediaRoot），WebUI 只浏览和操作这个目录内的文件，避免误操作到其他盘或其他文件夹。
    
- WebUI 需要适配不同屏幕比例与窗口大小（响应式布局）。
    

### 2. 首页结构（信息架构）

WebUI 首页是一个 **n×n 网格**，固定展示以下 5 个入口（每个入口是一张卡片）：

1. **图片（Images）**
    
2. **散图（Scattered）**（不在相册里的图片）
    
3. **视频（Videos）**
    
4. **游戏（Games）**（暂时不重点实现）
    
5. **其他（Others）**（非上述类型的文件）
    

点击入口后**不跳转到新页面**，而是在同一网页内切换视图（保持使用流畅）。

### 3. 文件分类与展示规则

#### 3.1 图片（Images：按“相册”展示）

- 把 MediaRoot 下的图片按“相册（Album）”组织成**相册**：
    
    - **只有叶子图片文件夹算相册**：MediaRoot 下直接含 ≥1 张图片，且其子目录及后代不再包含图片的目录被视为一个相册；父文件夹只作为容器/分组，不重复计为相册。子目录仅包含视频/游戏/其他文件时，不影响该判定。
        
    - UI 上 Images 视图平铺展示所有叶子相册卡片；相册标题展示相对路径以反映层级（例如 `旅行/2024/海边`）。
        
- 每个相册在列表中显示一个封面缩略图：
    
    - 从相册内随机选 4 张图，拼成一个 2×2 的“四宫格”缩略图。
        
    - 缩略图下方显示相册文件夹名称。
        

#### 3.2 散图（Scattered：按“图片文件”扁平展示）

- “散图”指 MediaRoot 下**所有不在任何相册文件夹路径内的图片**，不限制在根目录；只要上级路径不是叶子相册，就归入散图。
    
    - 例如：`MediaRoot/封面.jpg`、`MediaRoot/临时/xxx.png` 若其所在目录不是叶子相册，则都出现在散图视图。
    
- 散图页面以**扁平列表**展示每一张图片（按文件为单位）。  
    - 散图页面提供“一键整理/归档”能力：将散图移动至预设目录 `MediaRoot/_unsorted/`（目录不存在则自动创建），并记录操作日志。
    

#### 3.3 视频（Videos：按“视频文件”扁平展示）

- 我不关心视频原本在哪个子文件夹里，我只想看到“每一个视频文件”。  
    所以 Videos 页面以**扁平列表**展示所有视频文件。
    
- 每个视频在列表中显示一个封面缩略图：
    
    - 从视频中随机截取 4 帧画面，拼成 2×2 四宫格缩略图。
        
    - 缩略图下方显示视频文件名（例如 `我的假期.mp4`）。
        

#### 3.4 游戏（Games：暂时不重点实现）

- 游戏文件格式可能很多（exe、bat 等），并且可能既有文件夹也有散装文件。
    
- 现阶段游戏入口可先做成占位或简单列表展示，不实现复杂功能。
    

#### 3.5 其他（Others）

- 任何不属于图片/散图/视频/游戏的文件，都归入“其他”，先按列表展示即可。
    

### 4. 核心交互体验（同页弹窗）

- 当我点击**图片相册的缩略图**时：
    
    - 不跳转新页面，而是在当前页面弹出图片查看器（overlay）。
        
    - 默认打开该相册的第一张图。
        
    - 我可以左右切换（按钮/键盘/滑动）浏览相册内所有图片。
        
- 当我点击**视频文件的缩略图**时：
    
    - 不跳转新页面，而是在当前页面弹出视频播放器（overlay）。
        
    - 默认立即开始播放，并支持基本控制（暂停、音量、全屏、拖动进度）。
        

### 5. 文件管理能力（高优先级但要安全）

WebUI 需要支持我对文件/文件夹进行整理：

- 删除文件/文件夹
    
- 移动文件/文件夹
    

但必须保证安全：

- 操作前要有明确的二次确认
    
- 源/目标路径必须都在 MediaRoot 内（软删除/回收站也不例外）
    
- 要有操作日志（方便追查误操作）
    

软删除/回收站在 MVP **默认开启**：删除时先移入 `MediaRoot/_trash/`（位于 MediaRoot 内自动创建，默认不参与索引/分类展示），可在 UI 中恢复或彻底清空；回收站文件默认保留 10 天后自动清理。

### 6. 性能与兼容性目标（务实版本）

- 面向大库使用：缩略图要缓存、列表要懒加载，避免一次性加载导致卡顿。
    
- 目标是尽量支持高规格播放（例如 4K@240），但最终能否流畅播放**取决于硬件性能与视频编码**；需要通过实际设备测试验证。
    
- 图片/视频格式方面：会尽量覆盖常见格式；对浏览器无法直接播放/显示的格式，需要给出明确提示与处理建议（例如提示转码/提示使用外部播放器）。
