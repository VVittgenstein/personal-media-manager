## 文件：{{read_only.md}}  
项目：“{{PROJECT_TEXT}}”  
版本：0.1  
日期：2025-12-12  
derived_from：“深度研究（上下文中的原始笔记）”

# {{PROJECT_TEXT}} · DR 结论（只读）

> 本文是从上游调研原文蒸馏的**结论性文档**，用于人审阅与 6b 机读抽取。  
> 约定：文中方括号标注 [EVID-###] 以指向“参考文献”。

## 1. 背景&目标

- 目标（What/Why）：在 **Windows 本地**运行一个个人媒体库 WebUI，面向“文件很多、层级较乱”的本地资源，通过浏览器提升浏览与整理效率； 不上传云端。 [EVID-001][EVID-002]
    
- 运行方式：用户**双击 .bat** 启动本地后端服务，并**自动打开浏览器**访问本地页面（localhost）。 [EVID-001][EVID-002]
    
- 成功判据（对 MVP 的可验证结果）：
    
    - 能在页面内按规定分类浏览 MediaRoot 内资源（图片相册/散图/视频/游戏/其他），并通过同页 Overlay 查看图片/播放视频。 [EVID-001][EVID-002]
        
    - 在中等规模媒体库下达到目标级体验（如首屏、进入列表、搜索响应等指标）。 [EVID-002]
        
    - 敏感文件操作（删除/移动）具备“MediaRoot 沙箱、二次确认、操作日志、软删除/回收站（MVP 默认开启）”的安全防线。 [EVID-001][EVID-002]
        
- 非目标 / 暂不覆盖：
    
    - 不做云端同步/公开分享/多用户远程网盘式访问。 [EVID-002]
        
    - 不做复杂内容分析（如人脸识别、AI 标签）。 [EVID-002]
        
    - Games 入口**暂不重点实现**（可占位或简单列表）。 [EVID-001][EVID-002]
        
    - 不专门做移动端 App（仅要求 Web 响应式在 PC 浏览器可用）。 [EVID-001][EVID-002]
        

## 2. 结论总览（Top Insights）

- (C1) **推荐自研定制 WebUI（方案C）**：在功能契合度、可扩展性与许可风险控制方面综合最优； Photoview/ FileBrowser/ Jellyfin 等更适合作为“参考实现/对标”，而非直接满足全部定制需求。 [EVID-002][EVID-003][EVID-004][EVID-006]
    
- (C2) 面向大库体验的关键在于：**缩略图预生成+缓存**、**前端懒加载/分页/虚拟列表**，避免一次性加载导致卡顿。 [EVID-002][EVID-003][EVID-007]
    
- (C3) 文件管理能力（删除/移动）是高价值但高风险点，必须以 **MediaRoot 沙箱 + 路径校验 + 二次确认 + 操作日志 + 软删除/回收站**（MVP 默认开启）为硬约束。 [EVID-001][EVID-002]
    
- (C4) 交互体验要点：主页 5 入口卡片，分类视图**同页切换**； 媒体打开采用 **Overlay（modal）**，关闭后回到原位置、避免页面跳转。 [EVID-001][EVID-002]
    
- (C5) 视频预览缩略图需要后端处理：**FFmpeg 抽帧（4 帧）→ 2×2 拼图**； 同时需正视浏览器编解码/封装支持差异并提供提示与外部打开建议。 [EVID-002][EVID-008]
    

## 3. 关键决策与约束（决策与约束）

> 6b 将据此拆出决策/约束类任务与校验。

- D1. 决策：定位为**本地 WebUI**（localhost），默认不依赖云 API、不上传内容； 通过脚本（.bat）一键启动并自动打开浏览器。 [EVID-001][EVID-002]
    
- D2. 决策：以用户指定的 **MediaRoot** 作为唯一可扫描与可操作范围（安全沙箱）。 [EVID-001][EVID-002]
    
- D3. 决策：首页信息架构固定 5 个入口卡片（Images / Scattered / Videos / Games / Others），点击后**同页切换视图**而非新页面跳转。 [EVID-001][EVID-002]
    
- D4. 决策：Images 视图按“叶子图片目录即相册（Album）”组织（含图片且子目录及后代不再含图片）； 相册卡片封面为**随机 4 图 2×2 四宫格**，下方展示文件夹名。 [EVID-001][EVID-002]
    
- D5. 决策：散图（Scattered）= MediaRoot 下所有 **不在任何相册（Album）路径内** 的图片文件（不限深度）； Scattered 视图以图片文件为单位**扁平展示散图**； 可提供“一键整理”将散图移动到预设目录 `MediaRoot/_unsorted/`。 [EVID-001][EVID-002]
    
- D6. 决策：Videos 视图按视频文件为单位**扁平聚合**（不关心原目录层级）； 缩略图为**随机/均匀抽取 4 帧 2×2 拼图**，并显示文件名。 [EVID-001][EVID-002]
    
- D7. 决策：Games 暂时占位/简单列表展示； 并强调“避免误触执行可执行文件”。 [EVID-001][EVID-002]
    
- D8. 决策：Others 收纳非上述类型文件，先按列表展示（可含基础元信息）。 [EVID-001][EVID-002]
    
- Z1. 约束（安全）：删除/移动必须二次确认； 后端必须限制在 MediaRoot 内； 必须记录操作日志； 软删除/回收站在 MVP 默认开启：删除即移动到 `MediaRoot/_trash/`（自动创建，默认不参与索引/分类展示），回收站文件默认保留 10 天后自动清理；支持恢复/彻底清空。 [EVID-001][EVID-002]
    
- Z2. 约束（媒体展示）：图片/视频在查看器中需**保持宽高比不变**并按可用区域**最大等比缩放**； 默认“完整可见”，不允许拉伸或裁切； “不允许留黑边”的定义与实现方式需进一步澄清（见第10节）。 [EVID-001][EVID-002]
    
- Z3. 约束（性能）：缩略图需缓存； 列表需懒加载（必要时分页/虚拟列表）； 避免一次性加载导致卡顿。 [EVID-002][EVID-007]
    
- Z4. 约束（播放能力）：目标尽量支持高规格播放（如 4K@240）； 最终流畅度受硬件与编码影响，需要通过设备测试验证并在说明中给出“硬件相关”的明确提示。 [EVID-001][EVID-002]
    
- Z5. 约束（许可/合规）：对外分发时需关注第三方组件许可（尤其 FFmpeg、以及 Photoview/Jellyfin 等强 copyleft 项目）； 自研方案用于降低许可掣肘。 [EVID-002][EVID-006][EVID-009]
    

## 4. 需求提炼（可执行）

> 每条均含“验收要点（acceptance-hint）”便于 6b 生成 acceptance。

### 4.1 功能性需求（FR）

- FR-01：MediaRoot 配置与沙箱化扫描：用户可指定 MediaRoot，系统仅扫描/展示该目录及其子项。 [EVID-001][EVID-002]  
    验收要点：尝试访问 MediaRoot 外路径（含 等）应被拒绝； UI 不展示 MediaRoot 外任何文件。`..`
    
- FR-02：首页 5 入口卡片与同页切换：固定展示 Images / Scattered / Videos / Games / Others； 点击入口在同一页面切换视图。 [EVID-001][EVID-002]  
    验收要点：切换分类时不触发整页刷新； 返回时保留上次滚动位置或可用的返回体验（至少不丢失上下文）。
    
- FR-03：Images=相册（按文件夹）：识别 MediaRoot 下“叶子图片目录”为相册（目录直接含图片，且其子目录及后代不再包含图片；父目录仅作容器不重复计为相册）； 相册卡片展示 2×2 四宫格封面与文件夹名。 [EVID-001][EVID-002]  
    验收要点：目录含图片但其任一子目录/后代目录也含图片时，该目录不计为相册（仅叶子目录计为相册）； 相册封面由相册内 4 张图生成； 相册内容不变时封面不应频繁变化（除非明确设计为每次刷新随机）。
    
- FR-04：图片 Overlay 查看器：点击相册缩略图打开 Overlay，默认打开该相册第一张图； 支持上一张/下一张（按钮/键盘/滑动）。 [EVID-001][EVID-002]  
    验收要点：Overlay 打开/关闭不跳转页面； 切换图片不出错； 图片显示满足“等比缩放、完整可见、不拉伸不裁切”。 [EVID-001][EVID-002]
    
- FR-05：Scattered=散图扁平列表：散图=MediaRoot 下所有 **不在任何相册（Album）路径内** 的图片文件（不限深度），按图片文件扁平展示。 [EVID-001][EVID-002]  
    验收要点：散图判定以 Album 路径前缀归属为准；不在任何 Album 路径（含其子路径）内的图片均归入散图。 [EVID-002]
    
- FR-06：散图一键整理：提供“一键整理/归档”将散图移动至预设目录 `MediaRoot/_unsorted/`。 [EVID-001][EVID-002]  
    验收要点：执行后散图从列表消失且文件物理移动成功（目标：`MediaRoot/_unsorted/`）； 无散图时按钮禁用或给出提示； 日志记录该操作。 [EVID-002]
    
- FR-07：Videos=视频文件扁平聚合：聚合展示 MediaRoot 内所有视频文件； 每项显示文件名与 2×2 预览缩略图。 [EVID-001][EVID-002]  
    验收要点：同一视频缩略图可复用缓存； 列表不依赖原目录层级。
    
- FR-08：视频 Overlay 播放器：点击视频缩略图在当前页弹出播放器，默认立即播放； 支持播放/暂停、音量、全屏、拖动进度。 [EVID-001][EVID-002]  
    验收要点：常见可播放格式能正常播放； 不可播放的格式给出明确提示与处理建议（转码/外部播放器打开）。 [EVID-002]
    
- FR-09：文件管理（删除/移动）：对文件/文件夹提供删除与移动； 仅作用于 MediaRoot 内； 操作前二次确认； 记录操作日志； 软删除/回收站在 MVP 默认开启：删除即移动到 `MediaRoot/_trash/`（位于 MediaRoot 内自动创建，默认不参与索引/分类展示），回收站文件默认保留 10 天后自动清理；支持恢复/彻底清空。 [EVID-001][EVID-002]  
    验收要点：删除默认移动到 `MediaRoot/_trash/`； `_trash` 默认不参与索引/分类展示； 回收站文件超过 10 天自动清理； 可恢复/彻底清空； 删除/移动前弹窗清晰展示目标与影响范围； 操作后 UI 与磁盘一致； 日志可追溯时间、动作、源/目标路径。 [EVID-002]
    
- FR-10：搜索（按名称模糊匹配）：提供全局搜索框，按文件/文件夹名称关键字检索并定位到相册或文件。 [EVID-002]  
    验收要点：支持部分匹配与大小写不敏感； 点击结果能进入对应视图并打开/定位目标（相册或具体媒体）。 [EVID-002]
    

### 4.2 非功能性需求（NFR）

- NFR-01：性能（首屏/进入列表/搜索）：目标首屏 <3s，进入相册或列表 <2s； 搜索响应 <1s（另有更严格目标：大规模 100ms 级）。 [EVID-002]  
    验收要点：提供可复现测试集与测试方法（开发者工具/日志）记录并对照指标。
    
- NFR-02：规模适配：至少支持“数千张图片 + 数百视频”的库规模下仍可流畅滚动浏览； 缩略图缓存与懒加载避免浏览器负担过高。 [EVID-002][EVID-007]  
    验收要点：长列表滚动掉帧不明显、内存占用可控； 可通过分页/虚拟列表控制同屏渲染量。 [EVID-002]
    
- NFR-03：可靠性：连续运行与高频打开/关闭 Overlay、执行删除/移动等操作后不崩溃； 异常（缩略图缺失/生成失败/文件被外部修改）有降级与提示。 [EVID-002]  
    验收要点：2 小时稳定性测试与异常场景测试通过； 日志无大量未处理异常。
    
- NFR-04：安全：防路径穿越（）、仅 MediaRoot 内可操作； 前端对特殊字符转义避免 XSS； 危险操作强确认。 [EVID-002]  
    验收要点：对恶意请求/输入进行测试，服务端拒绝并记录； UI 不出现脚本注入。`..`
    
- NFR-05：兼容性与布局：Windows 10/11 为主要目标； 页面响应式适配不同屏幕比例与窗口大小； 主流浏览器（Chrome/Edge/Firefox）体验一致。 [EVID-001][EVID-002]  
    验收要点：在多分辨率下布局不崩； 中文文件名无乱码； 基础功能一致。
    

## 5. 技术路径与方案对比（若适用）

|方案|适用场景|优点|风险/代价|证据|
|---|---|---|---|---|
|A. 基于 Photoview 二次开发|已接受其架构（含数据库）且能遵守其许可； 以“照片/视频相册”为主|目录即相册、自动缩略图、懒加载等成熟经验可复用|系统较重、定制成本高； 对“其他文件/游戏”等定制不足； 许可与分发约束需评估|[EVID-002][EVID-003]|
|B. 基于 FileBrowser 组合/轻改|只需通用文件管理 UI，且接受“按目录浏览”为主|部署简单、通用文件操作能力较全|缺少相册封面拼图与视频缩略图等核心体验； 项目维护模式限制新增特性|[EVID-002][EVID-004]|
|C. 自主开发定制 WebUI（推荐）|需要严格贴合定制 IA/交互/安全策略，且希望可控演进|功能契合度高、架构可裁剪； 可围绕缓存/懒加载/安全做定制|初期开发工作量最大； 需自行落地扫描、缓存、UI、播放器等细节|[EVID-002][EVID-007][EVID-008]|

> 推荐：方案 C（自研定制 WebUI）。 理由：能完整实现“5入口同页切换 + 相册/散图/视频聚合 + 2×2 缩略图策略 + 安全文件操作 + 大库性能策略”，同时避免引入重型系统与强 copyleft 许可对未来分发造成限制。 [EVID-002]

## 6. 外部依赖与阻断

- 依赖（本地）：后端运行环境与 Web 框架、图像处理库、视频抽帧工具（FFmpeg）、前端框架与组件库、（可选）SQLite 用于索引/日志持久化。 [EVID-002]
    
- 依赖（内容/格式）：浏览器对视频格式支持有限，需准备“不支持时的提示与建议/外部打开路径”。 [EVID-002]
    
- 潜在阻断点（需尽早决策/验证）：
    
    - FFmpeg 的集成方式与许可合规（尤其若计划对外分发）。 [EVID-002][EVID-009]
        
    - “不允许留黑边”与“完整可见、不可裁切”的实现定义（见第10节）。 [EVID-001][EVID-002]
        

## 7. 风险清单（含缓解）

- R-01：误删/误移动导致数据不可逆丢失（高影响×中概率）。 [EVID-001][EVID-002]  
    缓解：MediaRoot 路径校验；强二次确认；操作日志；软删除/回收站（MVP 默认开启）。 [EVID-002]
    
- R-02：大规模媒体库导致扫描/缩略图生成/前端渲染卡顿（中高影响×中概率）。 [EVID-002]  
    缓解：增量扫描与缓存；缩略图预生成；前端懒加载/分页/虚拟列表；以 Spike 压测确定参数。 [EVID-002][EVID-007]
    
- R-03：视频格式兼容性与播放性能不可控（中影响×中概率）。 [EVID-002]  
    缓解：扫描/播放时提示不兼容格式；提供外部播放器打开建议；对高规格视频明确“取决于硬件与编码”。 [EVID-001][EVID-002]
    
- R-04：第三方许可与分发合规风险（中影响×低概率）。 [EVID-002]  
    缓解：锁定依赖并整理 LICENSE；避免不必要的强 copyleft 依赖；明确 FFmpeg 使用方式与许可边界。 [EVID-002][EVID-006][EVID-009]
    
- R-05：个人全栈开发进度与范围蔓延（中影响×低-中概率）。 [EVID-002]  
    缓解：按 P0（浏览+Overlay+安全删除（含软删除/回收站））→P1（移动/搜索）→P2（监听更新/高级优化）迭代交付；先完成 MVP 验收再扩展。 [EVID-002]
    

## 8. 开放问题（需要结论的人/时间）

- Q-01：相册嵌套（多级文件夹）在 UI 中的呈现方式（平铺所有子孙相册 vs 分层导航）。 [EVID-002]  
    责任人：unknown； 需要证据：典型目录深度与用户浏览习惯； 期望截止：unknown。
    
- Q-02：Games 识别规则与交互边界（仅展示 vs 是否允许启动； 如何避免误执行）。 [EVID-001][EVID-002]  
    责任人：unknown； 需要证据：游戏文件结构样本； 期望截止：unknown。
    
- Q-03：回收站在 UI 中的呈现与操作范围（是否单独“回收站”视图；恢复/清空/批量操作交互）。 [EVID-002]  
    责任人：unknown； 需要证据：UI 草图/交互流程与评审结论； 期望截止：unknown。
    
- Q-04：浏览器支持范围（仅 Windows + Chrome/Edge？ 是否要求 Firefox？ ）。 [EVID-002]  
    责任人：unknown； 需要证据：目标用户环境； 期望截止：unknown。
    
- Q-05：MediaRoot 动态更新策略（启动时一次性扫描 vs 定时扫描 vs 文件系统监听）。 [EVID-002]  
    责任人：unknown； 需要证据：性能/实时性取舍与测试结果； 期望截止：unknown。
    
- Q-06：视频缩略图抽帧策略（定间隔/随机 vs 场景变化检测； 避免全黑帧）。 ⚠️ [EVID-002][EVID-008]  
    责任人：unknown； 需要证据：不同策略在真实样本上的质量/耗时对比； 期望截止：unknown。
    
- Q-07：“不允许留黑边”的严格含义与可接受替代（背景填充/容器自适应等）。 [EVID-001][EVID-002]  
    责任人：unknown； 需要证据：明确验收口径； 期望截止：unknown。
    

## 9. 术语与域模型（可用于统一命名）

- MediaRoot：用户指定的媒体根目录； WebUI 仅扫描/操作其范围内路径，作为安全沙箱。 [EVID-001][EVID-002]
    
- 相册（Album）：MediaRoot 下的“叶子图片目录”（含图片且其子目录及后代不再包含图片）； 父目录仅作为容器，不重复计为相册。 [EVID-001][EVID-002]
    
- 散图（Scattered Images）：MediaRoot 下所有 **不在任何相册（Album）路径内** 的图片文件集合（不限深度）。 [EVID-001][EVID-002]
    
- 视频缩略图（Video Thumbnail）：后端用 FFmpeg 从视频抽取多帧并拼接成 2×2 预览图，用于列表展示。 [EVID-002][EVID-008]
    
- Overlay 查看器/播放器：同页弹窗（modal/overlay）方式展示媒体； 图片支持上一张/下一张，视频支持播放控制。 [EVID-001][EVID-002]
    
- 懒加载（Lazy Loading）：推迟加载非首屏资源以降低初始加载成本，提升滚动与渲染体验。 [EVID-002][EVID-007]
    
- 软删除（回收站）：MVP 默认开启；删除时不直接物理移除，而是移入 `MediaRoot/_trash/`（自动创建，默认不参与索引/视图展示），回收站文件默认保留 10 天后自动清理；支持恢复/彻底清空。 [EVID-002]
    
- 简要对象/关系（文字）：
    
    - MediaRoot → 包含 Folder/File（多层级） [EVID-001][EVID-002]
        
    - Folder（叶子图片目录）→ Album（用于 Images 视图） [EVID-001][EVID-002]
        
    - ImageFile → 归属 Album 或 Scattered [EVID-001][EVID-002]
        
    - 视频文件 → 扁平集合 [EVID-001][EVID-002]
        
    - Thumbnail Kache → （ImageThumb， AlbumCover， VideoPreview） 派生数据缓存 [Avid-002]
        
    - OperationLog → 记录 delete/move/archive 等变更 [EVID-002]
        

## 10. 证据一致性与时效

- 互相矛盾点（需明确验收口径）：
    
    - “媒体应最大等比缩放、完整可见、不可裁切/拉伸”与“**不允许留黑边**”在某些宽高比不一致场景下可能出现冲突； DR 同时提出“通过背景/容器策略避免纯黑边”的方向，但与“完全不留黑边”的字面要求存在解释空间。 ⚠️ [EVID-001][EVID-002]
        
    - 影响：直接影响 Overlay 查看器/播放器的布局实现与验收标准（需提前定义什么算“黑边”、可否接受背景填充/容器自适应）。 [EVID-001][EVID-002]
        
- 证据时效：
    
    - 最早发布日期：2013-01-18（FFmpeg 抽帧相关 Q&A，方法论可能仍适用但来源较旧）。 ⚠️ [EVID-008]
        
    - 最晚发布日期：2025-11-04（MDN Lazy Loading 指南）。 [EVID-007]
        
    - 多个项目官网类来源发布日期不确定（需在需要时复查页面更新时间/版本说明）。 ⚠️ [EVID-003][EVID-004]
        
- 数据缺口（需要追加调研/验证）：
    
    - 本机目标硬件上“4K@60/240”播放与资源占用的实际表现，需要 Spike 验证并据此调整指标与提示策略。 [EVID-001][EVID-002]
        
    - 大库（万级文件）下索引/缩略图生成策略、缓存位置与重建机制的最优组合，需要通过压测确定。 [EVID-002]
        

---

## 11. Action Seeds（供 6b 机读转 JSON； YAML，不等于最终任务）

```yaml
action_seeds:
  - id: ACT-001
    title: "实现 MediaRoot 扫描与媒体分类索引（Album/Scattered/Videos/Games/Others）"
    category: build
    rationale: "所有视图与搜索/操作均依赖稳定的索引；同时落实 MediaRoot 沙箱边界"
    evidence: ["EVID-001","EVID-002"]
    acceptance_hint: "给定 MediaRoot 样例目录：能正确产出相册列表、散图列表、视频扁平列表；索引不包含 MediaRoot 外路径；对异常文件名/特殊字符无崩溃"
    priority_guess: P0
    depends_on: []

  - id: ACT-002
    title: "实现图片缩略图与相册封面（4图2×2拼图）生成与缓存"
    category: build
    rationale: "支撑 Images 相册卡片与大库浏览性能（避免前端直接加载原图）"
    evidence: ["EVID-001","EVID-002"]
    acceptance_hint: "相册卡片显示拼图封面；缩略图生成后复用缓存；相册内容变更后能触发更新或重建"
    priority_guess: P0
    depends_on: ["ACT-001"]

  - id: ACT-003
    title: "集成 FFmpeg 生成视频 2×2 预览缩略图（4帧抽取）并缓存"
    category: build
    rationale: "视频列表需要直观预览；浏览器侧无法可靠生成代表性缩略图，需后端预处理"
    evidence: ["EVID-002","EVID-008"]
    acceptance_hint: "对支持的视频文件生成并展示 2×2 预览图；FFmpeg 不可用时给出明确错误提示与替代方案；缩略图可复用缓存"
    priority_guess: P0
    depends_on: ["ACT-001"]

  - id: ACT-004
    title: "实现 SPA 前端：首页5入口卡片 + 分类视图同页切换"
    category: build
    rationale: "满足“流畅不跳页”的核心交互；为 Overlay 查看器/播放器提供承载"
    evidence: ["EVID-001","EVID-002"]
    acceptance_hint: "点击入口在同一页面切换；返回保留上下文；在不同窗口尺寸下布局不崩"
    priority_guess: P0
    depends_on: ["ACT-001"]

  - id: ACT-005
    title: "实现图片 Overlay 查看器：首图打开 + 上下张导航 + 等比缩放规则"
    category: build
    rationale: "满足图片浏览核心路径；验证“等比缩放/完整可见/不裁切”的体验"
    evidence: ["EVID-001","EVID-002"]
    acceptance_hint: "打开相册后可连续浏览全部图片；键盘/按钮可用；图片显示不拉伸不裁切；对“黑边”处理符合已确认口径"
    priority_guess: P0
    depends_on: ["ACT-002","ACT-004"]

  - id: ACT-006
    title: "实现视频 Overlay 播放器：默认自动播放 + 基本控制 + 不支持格式提示"
    category: build
    rationale: "满足视频浏览核心路径；处理浏览器格式差异，避免黑屏无反馈"
    evidence: ["EVID-001","EVID-002"]
    acceptance_hint: "可播放格式正常播放且控制可用；不可播放格式显示明确提示（转码/外部播放器建议）；关闭 Overlay 后资源释放正常"
    priority_guess: P0
    depends_on: ["ACT-003","ACT-004"]

  - id: ACT-007
    title: "实现删除/移动 API 与前端交互：二次确认 + MediaRoot 路径校验 + 操作日志 + 软删除/回收站（MVP 默认开启）"
    category: build
    rationale: "高优先级整理能力，但必须安全可审计，降低误删风险"
    evidence: ["EVID-001","EVID-002"]
    acceptance_hint: "删除/移动前强确认且显示目标；拒绝 MediaRoot 外路径；每次操作写入日志（含时间、动作、源/目标）；删除默认软删除到 MediaRoot/_trash/（自动创建，默认不参与索引/视图展示），可恢复/清空且 10 天自动清理"
    priority_guess: P0
    depends_on: ["ACT-001","ACT-004"]

  - id: ACT-008
    title: "实现全局搜索：按名称模糊匹配并可定位到相册/文件"
    category: build
    rationale: "解决层级复杂时的快速定位，显著优于资源管理器查找体验"
    evidence: ["EVID-002"]
    acceptance_hint: "输入关键字能返回匹配项并支持点击定位；在万级条目下仍保持可接受响应（以测试报告记录实际表现）"
    priority_guess: P1
    depends_on: ["ACT-001","ACT-004"]

  - id: ACT-009
    title: "性能 Spike：缩略图生成、懒加载与大库滚动性能压测并出报告"
    category: spike
    rationale: "用可复现数据验证首屏/列表加载与生成耗时，确定缩略图尺寸与加载策略"
    evidence: ["EVID-002","EVID-007"]
    acceptance_hint: "按 DR 给出的测试规模与阈值执行；输出包含耗时、资源占用、瓶颈分析与参数建议的报告"
    priority_guess: P1
    depends_on: ["ACT-002","ACT-003","ACT-004"]

  - id: ACT-010
    title: "交付形态：.bat 一键启动本地服务并自动打开浏览器（含端口冲突处理与基础配置）"
    category: build
    rationale: "满足核心使用方式，降低启动门槛"
    evidence: ["EVID-001","EVID-002"]
    acceptance_hint: "双击 bat 后服务可用并打开默认浏览器；端口冲突有提示或自动换端口；MediaRoot 可通过配置或启动参数设置"
    priority_guess: P1
    depends_on: ["ACT-004","ACT-001"]

  - id: ACT-011
    title: "许可与分发合规梳理（FFmpeg/第三方库）：形成可执行的 LICENSE 清单与选择结论"
    category: doc
    rationale: "避免未来对外分发时触发不符合预期的开源义务；提前锁定依赖策略"
    evidence: ["EVID-002","EVID-006","EVID-009"]
    acceptance_hint: "输出依赖清单、许可证类型、分发注意事项；对 FFmpeg 集成方式给出可执行结论（例如是否要求用户自行安装等）"
    priority_guess: P2
    depends_on: []

  - id: ACT-012
    title: "需求澄清决策：相册嵌套呈现、软删除策略、'不留黑边'验收口径"
    category: decision
    rationale: "多处未决点会显著影响实现与验收；需尽早确定以避免返工"
    evidence: ["EVID-001","EVID-002"]
    acceptance_hint: "形成书面决策（方案+示例+验收口径）；同步到产品说明与测试用例"
    priority_guess: P0
    depends_on: []

```
## 12. 外部依赖（供 6b 识别依赖态;YAML）
```yaml
external_dependencies:
  - id: DEP-001
    name: "FFmpeg（视频抽帧/缩略图生成）"
    status: unknown
    blocker: "需确定 Windows 集成方式（随包分发 vs 用户自装）与许可证合规边界"
    unblock_plan: "选定集成策略并形成 LICENSE/NOTICE；在构建/运行时检测 FFmpeg 可用性并给出指引"
    evidence: ["EVID-002","EVID-009"]

  - id: DEP-002
    name: "浏览器音视频格式支持范围（HTML5 播放能力差异）"
    status: unknown
    blocker: "部分封装/编码浏览器可能无法播放，需产品提示与外部打开方案"
    unblock_plan: "定义支持格式清单与不支持时 UI 提示策略；在测试集上验证并更新文档"
    evidence: ["EVID-002"]

  - id: DEP-003
    name: "大库测试集与目标硬件基准（用于 4K/高帧率播放与滚动性能验证）"
    status: unknown
    blocker: "未有统一可复现测试集/硬件基线，性能目标可能无法落地或无法对齐"
    unblock_plan: "按 DR 的 Spike 方案构造测试集并记录硬件参数；固化测试方法与阈值解释"
    evidence: ["EVID-001","EVID-002","EVID-007"]

```
## 13. 参考文献（附来源日期）

> 统一 ISO-8601； 若发布日期缺失，写 published: unknown。 URL 按要求以代码形式呈现。

- [EVID-001] 项目需求说明（对话上下文） — 用户 — 发布时间未知 — 访问时间：2025-12-12 — 网址：`N/A (conversation context)`
    
- [EVID-002]研究报告 — 个人媒体库本地WebUI项目 — 作者/机构：未知 — 发表时间：2025-12-12 — 访问时间：2025-12-12 — 网址：`N/A (local attachment: DR结论.md)`
    
    DR结论
    
- [EVID-003]Photoview（官方网站） — Photoview 开源项目 — 发布时间：未知 — 访问时间：2025-12-12 — 网址： ⚠️`https://photoview.github.io/`
    
- [EVID-004]File Browser 首页 — FileBrowser 开发者/项目 — 发布时间：未知 — 访问时间：2025-12-12 — 网址： ⚠️`https://filebrowser.org/index.html`
    
- [EVID-005]文件 — 单文件PHP应用 — Photo.gallery / 文件画廊团队 — 发布时间：2025-01-05 — 访问时间：2025-12-12 — 网址：`https://www.files.gallery/`
    
- [EVID-006]自由软件媒体系统（Jellyfin）— Jellyfin 社区 — 发布时间：2025-10-10 — 访问时间：2025-12-12 — 网址：`https://jellyfin.org/`
    
- [EVID-007]懒加载——性能 — MDN Web Docs — 发布时间：2025-11-04 — 访问时间：2025-12-12 — 网址：`https://developer.mozilla.org/en-US/docs/Web/Performance/Guides/Lazy_loading`
    
- [EVID-008]使用FFmpeg视频的有意义缩略图（问答）——超级用户——发布时间：2013-01-18 - 访问时间：2025-12-12 ——网址： ⚠️`https://superuser.com/questions/538112/meaningful-thumbnails-for-a-video-using-ffmpeg`
    
- [EVID-009]Video.js – GitHub（Apache-2.0 许可说明） — Video.js / Brightcove — 发布时间：未知 — 访问时间：2025-12-12 — 网址： ⚠️`https://github.com/videojs/video.js`
    

## 14. 变更记录

v0.1（2025-12-12）：首次从 DR 蒸馏，建立结论与 YAML 种子。
